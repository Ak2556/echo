{"version":3,"sources":["/home/runner/work/echo/echo/frontend/src/components/miniapps/__tests__/DairyFarmManagerApp.test.tsx"],"sourcesContent":["import React from 'react';\nimport { render, screen, fireEvent } from '@testing-library/react';\nimport '@testing-library/jest-dom';\nimport DairyFarmManagerApp from '../DairyFarmManagerApp';\n\ndescribe('DairyFarmManagerApp - Records flows', () => {\n  test('opens view modal when clicking View Details', async () => {\n    render(<DairyFarmManagerApp isVisible={true} onClose={() => {}} />);\n\n    // Click the Records tab to render the records list\n    const recordsTabs = screen.getAllByText(/Records/i);\n    const recordsTab =\n      recordsTabs.find(\n        (el) =>\n          (el.textContent || '').trim().startsWith('ðŸ“‹') &&\n          !(el.textContent || '').includes('View')\n      ) || recordsTabs[0];\n    fireEvent.click(recordsTab);\n\n    // Confirm at least one record (by tag) is visible\n    const tagText = await screen.findByText(/001-GIR-2022/i);\n    expect(tagText).toBeInTheDocument();\n  });\n\n  test('deletes a record when confirmed', async () => {\n    render(<DairyFarmManagerApp isVisible={true} onClose={() => {}} />);\n\n    // Click the Records tab to render the records list\n    const recordsTabs = screen.getAllByText(/Records/i);\n    const recordsTab =\n      recordsTabs.find(\n        (el) =>\n          (el.textContent || '').trim().startsWith('ðŸ“‹') &&\n          !(el.textContent || '').includes('View')\n      ) || recordsTabs[0];\n    fireEvent.click(recordsTab);\n\n    // Find all delete buttons\n    const deleteButtons = await screen.findAllByText(/Delete/i);\n    expect(deleteButtons.length).toBeGreaterThan(0);\n\n    // Mock confirm to return true\n    const originalConfirm = window.confirm;\n    window.confirm = jest.fn(() => true) as any;\n\n    // Capture a tag value present before deletion\n    const tagText = await screen.findByText(/001-GIR-2022/i);\n    expect(tagText).toBeInTheDocument();\n\n    fireEvent.click(deleteButtons[0]);\n\n    // After deletion, the specific tag may no longer be in the document\n    expect(screen.queryByText(/001-GIR-2022/i)).not.toBeInTheDocument();\n\n    // restore\n    window.confirm = originalConfirm;\n  });\n});\n"],"names":["describe","test","render","DairyFarmManagerApp","isVisible","onClose","recordsTabs","screen","getAllByText","recordsTab","find","el","textContent","trim","startsWith","includes","fireEvent","click","tagText","findByText","expect","toBeInTheDocument","deleteButtons","findAllByText","length","toBeGreaterThan","originalConfirm","window","confirm","jest","fn","queryByText","not"],"mappings":";;;;;8DAAkB;wBACwB;QACnC;4EACyB;;;;;;AAEhCA,SAAS,uCAAuC;IAC9CC,KAAK,+CAA+C;QAClDC,IAAAA,cAAM,gBAAC,qBAACC,4BAAmB;YAACC,WAAW;YAAMC,SAAS,KAAO;;QAE7D,mDAAmD;QACnD,MAAMC,cAAcC,cAAM,CAACC,YAAY,CAAC;QACxC,MAAMC,aACJH,YAAYI,IAAI,CACd,CAACC,KACC,AAACA,CAAAA,GAAGC,WAAW,IAAI,EAAC,EAAGC,IAAI,GAAGC,UAAU,CAAC,SACzC,CAAC,AAACH,CAAAA,GAAGC,WAAW,IAAI,EAAC,EAAGG,QAAQ,CAAC,YAChCT,WAAW,CAAC,EAAE;QACrBU,iBAAS,CAACC,KAAK,CAACR;QAEhB,kDAAkD;QAClD,MAAMS,UAAU,MAAMX,cAAM,CAACY,UAAU,CAAC;QACxCC,OAAOF,SAASG,iBAAiB;IACnC;IAEApB,KAAK,mCAAmC;QACtCC,IAAAA,cAAM,gBAAC,qBAACC,4BAAmB;YAACC,WAAW;YAAMC,SAAS,KAAO;;QAE7D,mDAAmD;QACnD,MAAMC,cAAcC,cAAM,CAACC,YAAY,CAAC;QACxC,MAAMC,aACJH,YAAYI,IAAI,CACd,CAACC,KACC,AAACA,CAAAA,GAAGC,WAAW,IAAI,EAAC,EAAGC,IAAI,GAAGC,UAAU,CAAC,SACzC,CAAC,AAACH,CAAAA,GAAGC,WAAW,IAAI,EAAC,EAAGG,QAAQ,CAAC,YAChCT,WAAW,CAAC,EAAE;QACrBU,iBAAS,CAACC,KAAK,CAACR;QAEhB,0BAA0B;QAC1B,MAAMa,gBAAgB,MAAMf,cAAM,CAACgB,aAAa,CAAC;QACjDH,OAAOE,cAAcE,MAAM,EAAEC,eAAe,CAAC;QAE7C,8BAA8B;QAC9B,MAAMC,kBAAkBC,OAAOC,OAAO;QACtCD,OAAOC,OAAO,GAAGC,KAAKC,EAAE,CAAC,IAAM;QAE/B,8CAA8C;QAC9C,MAAMZ,UAAU,MAAMX,cAAM,CAACY,UAAU,CAAC;QACxCC,OAAOF,SAASG,iBAAiB;QAEjCL,iBAAS,CAACC,KAAK,CAACK,aAAa,CAAC,EAAE;QAEhC,oEAAoE;QACpEF,OAAOb,cAAM,CAACwB,WAAW,CAAC,kBAAkBC,GAAG,CAACX,iBAAiB;QAEjE,UAAU;QACVM,OAAOC,OAAO,GAAGF;IACnB;AACF"}