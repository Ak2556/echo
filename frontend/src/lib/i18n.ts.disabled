import i18n from 'i18next';
import { initReactI18next } from 'react-i18next';
import LanguageDetector from 'i18next-browser-languagedetector';

// Import translation files
import enTranslation from '../locales/en/common.json';
import esTranslation from '../locales/es/common.json';
import frTranslation from '../locales/fr/common.json';
import deTranslation from '../locales/de/common.json';
import hiTranslation from '../locales/hi/common.json';
import arTranslation from '../locales/ar/common.json';
import zhTranslation from '../locales/zh/common.json';
import jaTranslation from '../locales/ja/common.json';
import ptTranslation from '../locales/pt/common.json';
import ruTranslation from '../locales/ru/common.json';

const resources = {
  en: {
    common: enTranslation,
  },
  es: {
    common: esTranslation,
  },
  fr: {
    common: frTranslation,
  },
  de: {
    common: deTranslation,
  },
  hi: {
    common: hiTranslation,
  },
  ar: {
    common: arTranslation,
  },
  zh: {
    common: zhTranslation,
  },
  ja: {
    common: jaTranslation,
  },
  pt: {
    common: ptTranslation,
  },
  ru: {
    common: ruTranslation,
  },
};

i18n
  .use(LanguageDetector)
  .use(initReactI18next)
  .init({
    resources,
    fallbackLng: 'en',
    debug: process.env.NODE_ENV === 'development',

    interpolation: {
      escapeValue: false, // React already escapes values
    },

    detection: {
      order: ['localStorage', 'navigator', 'htmlTag'],
      lookupLocalStorage: 'echo-language',
      caches: ['localStorage'],
    },

    ns: ['common'],
    defaultNS: 'common',
  });

export default i18n;

// Language configuration
export const languages = [
  { code: 'en', name: 'English', nativeName: 'English', flag: 'ðŸ‡ºðŸ‡¸', rtl: false },
  { code: 'es', name: 'Spanish', nativeName: 'EspaÃ±ol', flag: 'ðŸ‡ªðŸ‡¸', rtl: false },
  { code: 'fr', name: 'French', nativeName: 'FranÃ§ais', flag: 'ðŸ‡«ðŸ‡·', rtl: false },
  { code: 'de', name: 'German', nativeName: 'Deutsch', flag: 'ðŸ‡©ðŸ‡ª', rtl: false },
  { code: 'hi', name: 'Hindi', nativeName: 'à¤¹à¤¿à¤¨à¥à¤¦à¥€', flag: 'ðŸ‡®ðŸ‡³', rtl: false },
  { code: 'ar', name: 'Arabic', nativeName: 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©', flag: 'ðŸ‡¸ðŸ‡¦', rtl: true },
  { code: 'zh', name: 'Chinese', nativeName: 'ä¸­æ–‡', flag: 'ðŸ‡¨ðŸ‡³', rtl: false },
  { code: 'ja', name: 'Japanese', nativeName: 'æ—¥æœ¬èªž', flag: 'ðŸ‡¯ðŸ‡µ', rtl: false },
  { code: 'pt', name: 'Portuguese', nativeName: 'PortuguÃªs', flag: 'ðŸ‡§ðŸ‡·', rtl: false },
  { code: 'ru', name: 'Russian', nativeName: 'Ð ÑƒÑÑÐºÐ¸Ð¹', flag: 'ðŸ‡·ðŸ‡º', rtl: false },
];

export const getLanguage = (code: string) => languages.find(lang => lang.code === code);
export const isRTL = (code: string) => getLanguage(code)?.rtl || false;