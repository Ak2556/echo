============================= test session starts =============================
platform win32 -- Python 3.13.7, pytest-9.0.1, pluggy-1.6.0 -- C:\Python313\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\A.P\OneDrive\Desktop\echo-main\backend
configfile: pytest.ini (WARNING: ignoring pytest config in pyproject.toml!)
plugins: anyio-4.11.0, asyncio-1.3.0, cov-7.0.0, mock-3.15.1
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 1070 items

tests/integration/test_api_endpoints.py::TestHealthEndpoints::test_root_endpoint PASSED [  0%]
tests/integration/test_api_endpoints.py::TestHealthEndpoints::test_health_check PASSED [  0%]
tests/integration/test_api_endpoints.py::TestHealthEndpoints::test_metrics_endpoint PASSED [  0%]
tests/integration/test_api_endpoints.py::TestHealthEndpoints::test_stats_endpoint PASSED [  0%]
tests/integration/test_api_endpoints.py::TestUserEndpoints::test_list_users_admin PASSED [  0%]
tests/integration/test_api_endpoints.py::TestUserEndpoints::test_get_user_by_id PASSED [  0%]
tests/integration/test_api_endpoints.py::TestUserEndpoints::test_delete_user PASSED [  0%]
tests/integration/test_api_endpoints.py::TestPostEndpoints::test_create_post PASSED [  0%]
tests/integration/test_api_endpoints.py::TestPostEndpoints::test_list_posts PASSED [  0%]
tests/integration/test_api_endpoints.py::TestPostEndpoints::test_get_post_by_id PASSED [  0%]
tests/integration/test_api_endpoints.py::TestPostEndpoints::test_update_post PASSED [  1%]
tests/integration/test_api_endpoints.py::TestPostEndpoints::test_delete_post PASSED [  1%]
tests/integration/test_api_endpoints.py::TestChatEndpoints::test_send_chat_message PASSED [  1%]
tests/integration/test_api_endpoints.py::TestChatEndpoints::test_get_chat_history PASSED [  1%]
tests/integration/test_api_endpoints.py::TestFileUploadEndpoints::test_upload_file PASSED [  1%]
tests/integration/test_api_endpoints.py::TestFileUploadEndpoints::test_list_files PASSED [  1%]
tests/integration/test_api_endpoints.py::TestSearchEndpoints::test_search_posts PASSED [  1%]
tests/integration/test_api_endpoints.py::TestSearchEndpoints::test_search_with_filters PASSED [  1%]
tests/integration/test_api_endpoints.py::TestAnalyticsEndpoints::test_get_analytics PASSED [  1%]
tests/integration/test_api_endpoints.py::TestPaginationAndPerformance::test_pagination PASSED [  1%]
tests/integration/test_api_endpoints.py::TestPaginationAndPerformance::test_large_page_size_limit PASSED [  1%]
tests/integration/test_api_endpoints.py::TestErrorHandling::test_404_not_found PASSED [  2%]
tests/integration/test_api_endpoints.py::TestErrorHandling::test_405_method_not_allowed PASSED [  2%]
tests/integration/test_api_endpoints.py::TestErrorHandling::test_422_validation_error PASSED [  2%]
tests/integration/test_auth_endpoints.py::TestUserRegistration::test_register_success PASSED [  2%]
tests/integration/test_auth_endpoints.py::TestUserRegistration::test_register_duplicate_email PASSED [  2%]
tests/integration/test_auth_endpoints.py::TestUserRegistration::test_register_invalid_email PASSED [  2%]
tests/integration/test_auth_endpoints.py::TestUserRegistration::test_register_weak_password PASSED [  2%]
tests/integration/test_auth_endpoints.py::TestUserRegistration::test_register_missing_fields PASSED [  2%]
tests/integration/test_auth_endpoints.py::TestUserLogin::test_login_success PASSED [  2%]
tests/integration/test_auth_endpoints.py::TestUserLogin::test_login_wrong_password PASSED [  2%]
tests/integration/test_auth_endpoints.py::TestUserLogin::test_login_nonexistent_user PASSED [  2%]
tests/integration/test_auth_endpoints.py::TestUserLogin::test_login_missing_credentials PASSED [  3%]
tests/integration/test_auth_endpoints.py::TestTokenRefresh::test_refresh_token_success PASSED [  3%]
tests/integration/test_auth_endpoints.py::TestTokenRefresh::test_refresh_invalid_token PASSED [  3%]
tests/integration/test_auth_endpoints.py::TestTokenRefresh::test_refresh_expired_token PASSED [  3%]
tests/integration/test_auth_endpoints.py::TestPasswordReset::test_request_password_reset PASSED [  3%]
tests/integration/test_auth_endpoints.py::TestPasswordReset::test_request_password_reset_nonexistent_email PASSED [  3%]
tests/integration/test_auth_endpoints.py::TestEmailVerification::test_request_email_verification PASSED [  3%]
tests/integration/test_auth_endpoints.py::TestUserProfile::test_get_own_profile PASSED [  3%]
tests/integration/test_auth_endpoints.py::TestUserProfile::test_get_profile_without_auth PASSED [  3%]
tests/integration/test_auth_endpoints.py::TestUserProfile::test_update_profile PASSED [  3%]
tests/integration/test_auth_endpoints.py::TestAuthSecurity::test_rate_limiting PASSED [  4%]
tests/integration/test_auth_endpoints.py::TestAuthSecurity::test_sql_injection_protection PASSED [  4%]
tests/integration/test_auth_endpoints.py::TestAuthSecurity::test_xss_protection PASSED [  4%]
tests/integration/test_auth_endpoints.py::TestAuthSecurity::test_password_not_exposed_in_response PASSED [  4%]
tests/integration/test_auth_endpoints.py::TestTwoFactorAuth::test_enable_2fa PASSED [  4%]
tests/integration/test_auth_endpoints.py::TestTwoFactorAuth::test_verify_2fa_code PASSED [  4%]
tests/integration/test_auth_endpoints.py::TestTwoFactorAuth::test_disable_2fa PASSED [  4%]
tests/integration/test_shop_endpoints.py::TestProductEndpoints::test_list_products_success PASSED [  4%]
tests/integration/test_shop_endpoints.py::TestProductEndpoints::test_list_products_with_filters PASSED [  4%]
tests/integration/test_shop_endpoints.py::TestProductEndpoints::test_get_featured_products PASSED [  4%]
tests/integration/test_shop_endpoints.py::TestProductEndpoints::test_get_product_categories PASSED [  4%]
tests/integration/test_shop_endpoints.py::TestProductEndpoints::test_search_products PASSED [  5%]
tests/integration/test_shop_endpoints.py::TestProductEndpoints::test_search_products_with_category PASSED [  5%]
tests/integration/test_shop_endpoints.py::TestProductEndpoints::test_get_product_by_id_success PASSED [  5%]
tests/integration/test_shop_endpoints.py::TestProductEndpoints::test_get_product_by_id_not_found PASSED [  5%]
tests/integration/test_shop_endpoints.py::TestProductEndpoints::test_get_product_by_slug_success PASSED [  5%]
tests/integration/test_shop_endpoints.py::TestProductEndpoints::test_get_product_by_slug_not_found PASSED [  5%]
tests/integration/test_shop_endpoints.py::TestProductEndpoints::test_get_related_products PASSED [  5%]
tests/integration/test_shop_endpoints.py::TestProductEndpoints::test_create_product_as_seller PASSED [  5%]
tests/integration/test_shop_endpoints.py::TestProductEndpoints::test_create_product_as_student_forbidden PASSED [  5%]
tests/integration/test_shop_endpoints.py::TestProductEndpoints::test_update_product_as_owner PASSED [  5%]
tests/integration/test_shop_endpoints.py::TestProductEndpoints::test_update_product_not_owner PASSED [  5%]
tests/integration/test_shop_endpoints.py::TestProductEndpoints::test_update_product_not_found PASSED [  6%]
tests/integration/test_shop_endpoints.py::TestProductEndpoints::test_delete_product_as_owner PASSED [  6%]
tests/integration/test_shop_endpoints.py::TestProductEndpoints::test_delete_product_not_owner PASSED [  6%]
tests/integration/test_shop_endpoints.py::TestCartEndpoints::test_get_cart PASSED [  6%]
tests/integration/test_shop_endpoints.py::TestCartEndpoints::test_add_to_cart PASSED [  6%]
tests/integration/test_shop_endpoints.py::TestCartEndpoints::test_update_cart_item PASSED [  6%]
tests/integration/test_shop_endpoints.py::TestCartEndpoints::test_remove_from_cart PASSED [  6%]
tests/integration/test_shop_endpoints.py::TestCartEndpoints::test_clear_cart PASSED [  6%]
tests/integration/test_shop_endpoints.py::TestOrderEndpoints::test_create_order PASSED [  6%]
tests/integration/test_shop_endpoints.py::TestOrderEndpoints::test_get_user_orders PASSED [  6%]
tests/integration/test_shop_endpoints.py::TestOrderEndpoints::test_get_user_orders_with_status_filter PASSED [  7%]
tests/integration/test_shop_endpoints.py::TestOrderEndpoints::test_get_order_as_owner PASSED [  7%]
tests/integration/test_shop_endpoints.py::TestOrderEndpoints::test_get_order_not_owner PASSED [  7%]
tests/integration/test_shop_endpoints.py::TestOrderEndpoints::test_get_order_not_found PASSED [  7%]
tests/integration/test_shop_endpoints.py::TestOrderEndpoints::test_cancel_order_as_owner PASSED [  7%]
tests/integration/test_shop_endpoints.py::TestOrderEndpoints::test_cancel_order_not_owner PASSED [  7%]
tests/integration/test_shop_endpoints.py::TestReviewEndpoints::test_get_product_reviews PASSED [  7%]
tests/integration/test_shop_endpoints.py::TestReviewEndpoints::test_get_product_reviews_with_rating_filter PASSED [  7%]
tests/integration/test_shop_endpoints.py::TestReviewEndpoints::test_create_product_review_success PASSED [  7%]
tests/integration/test_shop_endpoints.py::TestReviewEndpoints::test_create_product_review_not_purchased PASSED [  7%]
tests/integration/test_shop_endpoints.py::TestReviewEndpoints::test_get_product_review_stats PASSED [  7%]
tests/integration/test_shop_endpoints.py::TestAdminEndpoints::test_admin_list_products_success PASSED [  8%]
tests/integration/test_shop_endpoints.py::TestAdminEndpoints::test_admin_list_products_non_admin PASSED [  8%]
tests/integration/test_shop_endpoints.py::TestAdminEndpoints::test_admin_list_products_with_filters PASSED [  8%]
tests/integration/test_shop_endpoints.py::TestAdminEndpoints::test_admin_list_orders_success PASSED [  8%]
tests/integration/test_shop_endpoints.py::TestAdminEndpoints::test_admin_list_orders_non_admin PASSED [  8%]
tests/integration/test_shop_endpoints.py::TestAdminEndpoints::test_admin_update_order_status_success PASSED [  8%]
tests/integration/test_shop_endpoints.py::TestAdminEndpoints::test_admin_update_order_status_non_admin PASSED [  8%]
tests/integration/test_shop_endpoints.py::TestAdminEndpoints::test_get_sales_analytics_success PASSED [  8%]
tests/integration/test_shop_endpoints.py::TestAdminEndpoints::test_get_sales_analytics_with_date_range PASSED [  8%]
tests/integration/test_shop_endpoints.py::TestAdminEndpoints::test_get_sales_analytics_non_admin PASSED [  8%]
tests/integration/test_tuition_endpoints.py::TestSessionEndpoints::test_list_sessions_as_student PASSED [  8%]
tests/integration/test_tuition_endpoints.py::TestSessionEndpoints::test_list_sessions_as_teacher PASSED [  9%]
tests/integration/test_tuition_endpoints.py::TestSessionEndpoints::test_get_upcoming_sessions_student PASSED [  9%]
tests/integration/test_tuition_endpoints.py::TestSessionEndpoints::test_get_session_by_id_success PASSED [  9%]
tests/integration/test_tuition_endpoints.py::TestSessionEndpoints::test_get_session_not_found PASSED [  9%]
tests/integration/test_tuition_endpoints.py::TestSessionEndpoints::test_get_session_no_access PASSED [  9%]
tests/integration/test_tuition_endpoints.py::TestSessionEndpoints::test_create_session_as_teacher PASSED [  9%]
tests/integration/test_tuition_endpoints.py::TestSessionEndpoints::test_create_session_as_student_forbidden PASSED [  9%]
tests/integration/test_tuition_endpoints.py::TestSessionEndpoints::test_update_session_as_owner PASSED [  9%]
tests/integration/test_tuition_endpoints.py::TestSessionEndpoints::test_start_session_as_teacher PASSED [  9%]
tests/integration/test_tuition_endpoints.py::TestSessionEndpoints::test_start_session_as_student_forbidden PASSED [  9%]
tests/integration/test_tuition_endpoints.py::TestSessionEndpoints::test_end_session_with_summary PASSED [ 10%]
tests/integration/test_tuition_endpoints.py::TestAttendanceEndpoints::test_get_session_attendance PASSED [ 10%]
tests/integration/test_tuition_endpoints.py::TestAttendanceEndpoints::test_get_session_attendance_no_access PASSED [ 10%]
tests/integration/test_tuition_endpoints.py::TestAttendanceEndpoints::test_mark_attendance_as_teacher PASSED [ 10%]
tests/integration/test_tuition_endpoints.py::TestAttendanceEndpoints::test_mark_attendance_as_student_forbidden PASSED [ 10%]
tests/integration/test_tuition_endpoints.py::TestAttendanceEndpoints::test_get_student_attendance_own PASSED [ 10%]
tests/integration/test_tuition_endpoints.py::TestAttendanceEndpoints::test_get_student_attendance_other_student_forbidden PASSED [ 10%]
tests/integration/test_tuition_endpoints.py::TestAssignmentEndpoints::test_list_assignments_as_student PASSED [ 10%]
tests/integration/test_tuition_endpoints.py::TestAssignmentEndpoints::test_get_assignment_by_id PASSED [ 10%]
tests/integration/test_tuition_endpoints.py::TestAssignmentEndpoints::test_get_assignment_no_access PASSED [ 10%]
tests/integration/test_tuition_endpoints.py::TestAssignmentEndpoints::test_create_assignment_as_teacher PASSED [ 10%]
tests/integration/test_tuition_endpoints.py::TestAssignmentEndpoints::test_submit_assignment_as_student PASSED [ 11%]
tests/integration/test_tuition_endpoints.py::TestAssignmentEndpoints::test_submit_assignment_as_teacher_forbidden PASSED [ 11%]
tests/integration/test_tuition_endpoints.py::TestAssignmentEndpoints::test_get_assignment_submissions PASSED [ 11%]
tests/integration/test_tuition_endpoints.py::TestAssignmentEndpoints::test_grade_submission_as_teacher PASSED [ 11%]
tests/integration/test_tuition_endpoints.py::TestStudyMaterialEndpoints::test_list_study_materials PASSED [ 11%]
tests/integration/test_tuition_endpoints.py::TestStudyMaterialEndpoints::test_get_study_material_by_id PASSED [ 11%]
tests/integration/test_tuition_endpoints.py::TestStudyMaterialEndpoints::test_create_study_material_as_teacher PASSED [ 11%]
tests/integration/test_tuition_endpoints.py::TestStudyMaterialEndpoints::test_upload_study_material PASSED [ 11%]
tests/integration/test_tuition_endpoints.py::TestQuizEndpoints::test_list_quizzes_as_student PASSED [ 11%]
tests/integration/test_tuition_endpoints.py::TestQuizEndpoints::test_create_quiz_as_teacher PASSED [ 11%]
tests/integration/test_tuition_endpoints.py::TestQuizEndpoints::test_start_quiz_attempt_as_student PASSED [ 11%]
tests/integration/test_tuition_endpoints.py::TestQuizEndpoints::test_start_quiz_as_teacher_forbidden PASSED [ 12%]
tests/integration/test_tuition_endpoints.py::TestQuizEndpoints::test_submit_quiz_attempt PASSED [ 12%]
tests/integration/test_tuition_endpoints.py::TestProgressReportEndpoints::test_get_progress_reports_as_student PASSED [ 12%]
tests/integration/test_tuition_endpoints.py::TestProgressReportEndpoints::test_generate_progress_report_as_teacher PASSED [ 12%]
tests/integration/test_tuition_endpoints.py::TestProgressReportEndpoints::test_generate_progress_report_as_student_forbidden PASSED [ 12%]
tests/integration/test_tuition_endpoints.py::TestAnalyticsEndpoints::test_get_course_analytics_as_teacher PASSED [ 12%]
tests/integration/test_tuition_endpoints.py::TestAnalyticsEndpoints::test_get_course_analytics_unauthorized_teacher PASSED [ 12%]
tests/integration/test_tuition_endpoints.py::TestAnalyticsEndpoints::test_get_student_analytics_own PASSED [ 12%]
tests/integration/test_tuition_endpoints.py::TestAnalyticsEndpoints::test_get_student_analytics_other_student_forbidden PASSED [ 12%]
tests/integration/test_users_endpoints.py::TestUserProfileEndpoints::test_get_my_profile_success PASSED [ 12%]
tests/integration/test_users_endpoints.py::TestUserProfileEndpoints::test_get_my_profile_no_username PASSED [ 12%]
tests/integration/test_users_endpoints.py::TestUserProfileEndpoints::test_get_my_profile_user_not_found PASSED [ 13%]
tests/integration/test_users_endpoints.py::TestUserProfileEndpoints::test_update_my_profile_put_success PASSED [ 13%]
tests/integration/test_users_endpoints.py::TestUserProfileEndpoints::test_update_my_profile_put_user_not_found PASSED [ 13%]
tests/integration/test_users_endpoints.py::TestUserProfileEndpoints::test_update_my_profile_put_partial_fields PASSED [ 13%]
tests/integration/test_users_endpoints.py::TestUserProfileEndpoints::test_update_my_profile_patch_success PASSED [ 13%]
tests/integration/test_users_endpoints.py::TestUserProfileEndpoints::test_update_my_profile_patch_user_not_found PASSED [ 13%]
tests/integration/test_users_endpoints.py::TestUserProfileEndpoints::test_update_my_profile_patch_all_fields PASSED [ 13%]
tests/integration/test_users_endpoints.py::TestUserLookupEndpoints::test_get_user_by_id PASSED [ 13%]
tests/integration/test_users_endpoints.py::TestUserLookupEndpoints::test_list_users_default_params PASSED [ 13%]
tests/integration/test_users_endpoints.py::TestUserLookupEndpoints::test_list_users_with_pagination PASSED [ 13%]
tests/integration/test_users_endpoints.py::TestUserLookupEndpoints::test_list_users_with_search PASSED [ 14%]
tests/integration/test_users_endpoints.py::TestUserLookupEndpoints::test_list_users_with_all_params PASSED [ 14%]
tests/integration/test_users_endpoints.py::TestUserLookupEndpoints::test_list_users_max_limit PASSED [ 14%]
tests/integration/test_users_endpoints.py::TestUserLookupEndpoints::test_list_users_exceeds_max_limit PASSED [ 14%]
tests/integration/test_users_endpoints.py::TestFollowEndpoints::test_follow_user_success PASSED [ 14%]
tests/integration/test_users_endpoints.py::TestFollowEndpoints::test_unfollow_user_success PASSED [ 14%]
tests/integration/test_users_endpoints.py::TestDeleteUserEndpoint::test_delete_own_user_success PASSED [ 14%]
tests/integration/test_users_endpoints.py::TestDeleteUserEndpoint::test_delete_other_user_forbidden PASSED [ 14%]
tests/integration/test_users_endpoints.py::TestDeleteUserEndpoint::test_delete_user_not_found PASSED [ 14%]
tests/integration/test_users_endpoints.py::TestUserProfileEdgeCases::test_get_profile_null_optional_fields PASSED [ 14%]
tests/integration/test_users_endpoints.py::TestUserProfileEdgeCases::test_update_profile_empty_strings PASSED [ 14%]
tests/integration/test_users_endpoints.py::TestUserProfileEdgeCases::test_update_profile_only_one_field PASSED [ 15%]
tests/integration/test_users_endpoints.py::TestUserProfileEdgeCases::test_user_model_without_bio_attribute PASSED [ 15%]
tests/integration/test_users_endpoints.py::TestUserAuthenticationErrors::test_get_profile_without_auth PASSED [ 15%]
tests/integration/test_users_endpoints.py::TestUserAuthenticationErrors::test_update_profile_without_auth PASSED [ 15%]
tests/integration/test_users_endpoints.py::TestUserAuthenticationErrors::test_delete_user_without_auth PASSED [ 15%]
tests/integration/test_users_endpoints.py::TestUserProfileValidation::test_update_profile_invalid_json PASSED [ 15%]
tests/integration/test_users_endpoints.py::TestUserProfileValidation::test_update_profile_very_long_strings PASSED [ 15%]
tests/integration/test_users_endpoints.py::TestComplexUserScenarios::test_multiple_profile_updates_sequence PASSED [ 15%]
tests/integration/test_users_endpoints.py::TestComplexUserScenarios::test_user_with_special_characters_in_email PASSED [ 15%]
tests/integration/test_users_endpoints.py::TestComplexUserScenarios::test_concurrent_profile_reads PASSED [ 15%]
tests/unit/test_auth_dependencies.py::TestAuthenticatedUser::test_authenticated_user_creation PASSED [ 15%]
tests/unit/test_auth_dependencies.py::TestAuthenticatedUser::test_authenticated_user_has_permission PASSED [ 16%]
tests/unit/test_auth_dependencies.py::TestAuthenticatedUser::test_authenticated_user_require_permission_success PASSED [ 16%]
tests/unit/test_auth_dependencies.py::TestAuthenticatedUser::test_authenticated_user_require_permission_failure PASSED [ 16%]
tests/unit/test_auth_dependencies.py::TestGetTokenFromRequest::test_get_token_from_authorization_header PASSED [ 16%]
tests/unit/test_auth_dependencies.py::TestGetTokenFromRequest::test_get_token_from_cookie PASSED [ 16%]
tests/unit/test_auth_dependencies.py::TestGetTokenFromRequest::test_get_token_no_token PASSED [ 16%]
tests/unit/test_auth_dependencies.py::TestGetTokenFromRequest::test_get_token_header_priority PASSED [ 16%]
tests/unit/test_auth_dependencies.py::TestGetCurrentUser::test_get_current_user_success PASSED [ 16%]
tests/unit/test_auth_dependencies.py::TestGetCurrentUser::test_get_current_user_no_token PASSED [ 16%]
tests/unit/test_auth_dependencies.py::TestGetCurrentUser::test_get_current_user_invalid_token PASSED [ 16%]
tests/unit/test_auth_dependencies.py::TestGetCurrentUser::test_get_current_user_blacklisted_token PASSED [ 17%]
tests/unit/test_auth_dependencies.py::TestGetCurrentUser::test_get_current_user_not_found PASSED [ 17%]
tests/unit/test_auth_dependencies.py::TestGetCurrentUser::test_get_current_user_inactive PASSED [ 17%]
tests/unit/test_auth_dependencies.py::TestGetCurrentUser::test_get_current_user_locked PASSED [ 17%]
tests/unit/test_auth_dependencies.py::TestGetCurrentUser::test_get_current_user_token_version_mismatch PASSED [ 17%]
tests/unit/test_auth_dependencies.py::TestGetCurrentUserOptional::test_get_current_user_optional_with_valid_token PASSED [ 17%]
tests/unit/test_auth_dependencies.py::TestGetCurrentUserOptional::test_get_current_user_optional_no_token PASSED [ 17%]
tests/unit/test_auth_dependencies.py::TestGetCurrentUserOptional::test_get_current_user_optional_invalid_token PASSED [ 17%]
tests/unit/test_auth_dependencies.py::TestRequireVerifiedEmail::test_require_verified_email_success PASSED [ 17%]
tests/unit/test_auth_dependencies.py::TestRequireVerifiedEmail::test_require_verified_email_unverified PASSED [ 17%]
tests/unit/test_auth_dependencies.py::TestRequire2FA::test_require_2fa_success PASSED [ 17%]
tests/unit/test_auth_dependencies.py::TestRequire2FA::test_require_2fa_not_enabled PASSED [ 18%]
tests/unit/test_auth_dependencies.py::TestRequire2FA::test_require_2fa_not_used_in_session PASSED [ 18%]
tests/unit/test_auth_dependencies.py::TestRequireScopes::test_require_scopes_creation PASSED [ 18%]
tests/unit/test_auth_dependencies.py::TestRequireScopes::test_require_scopes_success PASSED [ 18%]
tests/unit/test_auth_dependencies.py::TestRequireScopes::test_require_scopes_insufficient PASSED [ 18%]
tests/unit/test_auth_dependencies.py::TestRequireScopes::test_require_scopes_no_scopes PASSED [ 18%]
tests/unit/test_auth_dependencies.py::TestGetCurrentActiveUser::test_get_current_active_user PASSED [ 18%]
tests/unit/test_auth_redis_service.py::TestRedisService::test_fakeredis_import_error PASSED [ 18%]
tests/unit/test_auth_redis_service.py::TestRedisService::test_connect_fakeredis PASSED [ 18%]
tests/unit/test_auth_redis_service.py::TestRedisService::test_connect_real_redis PASSED [ 18%]
tests/unit/test_auth_redis_service.py::TestRedisService::test_disconnect PASSED [ 18%]
tests/unit/test_auth_redis_service.py::TestRedisService::test_disconnect_no_client PASSED [ 19%]
tests/unit/test_auth_redis_service.py::TestTokenBlacklist::test_blacklist_token PASSED [ 19%]
tests/unit/test_auth_redis_service.py::TestTokenBlacklist::test_is_token_blacklisted_true PASSED [ 19%]
tests/unit/test_auth_redis_service.py::TestTokenBlacklist::test_is_token_blacklisted_false PASSED [ 19%]
tests/unit/test_auth_redis_service.py::TestTokenBlacklist::test_blacklist_user_tokens PASSED [ 19%]
tests/unit/test_auth_redis_service.py::TestTokenBlacklist::test_blacklist_user_tokens_default_expiry PASSED [ 19%]
tests/unit/test_auth_redis_service.py::TestTokenBlacklist::test_is_user_tokens_blacklisted_true PASSED [ 19%]
tests/unit/test_auth_redis_service.py::TestTokenBlacklist::test_is_user_tokens_blacklisted_false PASSED [ 19%]
tests/unit/test_auth_redis_service.py::TestSessionManagement::test_store_session PASSED [ 19%]
tests/unit/test_auth_redis_service.py::TestSessionManagement::test_get_session_exists PASSED [ 19%]
tests/unit/test_auth_redis_service.py::TestSessionManagement::test_get_session_not_exists PASSED [ 20%]
tests/unit/test_auth_redis_service.py::TestSessionManagement::test_delete_session PASSED [ 20%]
tests/unit/test_auth_redis_service.py::TestSessionManagement::test_extend_session PASSED [ 20%]
tests/unit/test_auth_redis_service.py::TestRateLimiting::test_check_rate_limit_allowed_first_request PASSED [ 20%]
tests/unit/test_auth_redis_service.py::TestRateLimiting::test_check_rate_limit_allowed_subsequent_request PASSED [ 20%]
tests/unit/test_auth_redis_service.py::TestRateLimiting::test_check_rate_limit_exceeded PASSED [ 20%]
tests/unit/test_auth_redis_service.py::TestRateLimiting::test_get_rate_limit_remaining PASSED [ 20%]
tests/unit/test_auth_redis_service.py::TestRateLimiting::test_get_rate_limit_remaining_no_usage PASSED [ 20%]
tests/unit/test_auth_redis_service.py::TestRateLimiting::test_reset_rate_limit PASSED [ 20%]
tests/unit/test_auth_redis_service.py::TestVerificationCodes::test_store_verification_code PASSED [ 20%]
tests/unit/test_auth_redis_service.py::TestVerificationCodes::test_store_verification_code_default_expiry PASSED [ 20%]
tests/unit/test_auth_redis_service.py::TestVerificationCodes::test_verify_code_success PASSED [ 21%]
tests/unit/test_auth_redis_service.py::TestVerificationCodes::test_verify_code_invalid_code PASSED [ 21%]
tests/unit/test_auth_redis_service.py::TestVerificationCodes::test_verify_code_max_attempts_exceeded PASSED [ 21%]
tests/unit/test_auth_redis_service.py::TestVerificationCodes::test_verify_code_not_found PASSED [ 21%]
tests/unit/test_auth_redis_service.py::TestLoginAttempts::test_increment_failed_login_first_attempt PASSED [ 21%]
tests/unit/test_auth_redis_service.py::TestLoginAttempts::test_increment_failed_login_subsequent_attempt PASSED [ 21%]
tests/unit/test_auth_redis_service.py::TestLoginAttempts::test_reset_failed_login PASSED [ 21%]
tests/unit/test_auth_redis_service.py::TestLoginAttempts::test_get_failed_login_count_exists PASSED [ 21%]
tests/unit/test_auth_redis_service.py::TestLoginAttempts::test_get_failed_login_count_not_exists PASSED [ 21%]
tests/unit/test_auth_redis_service.py::TestTokenFamily::test_store_token_family PASSED [ 21%]
tests/unit/test_auth_redis_service.py::TestTokenFamily::test_get_token_family_exists PASSED [ 21%]
tests/unit/test_auth_redis_service.py::TestTokenFamily::test_get_token_family_not_exists PASSED [ 22%]
tests/unit/test_auth_redis_service.py::TestTokenFamily::test_invalidate_token_family PASSED [ 22%]
tests/unit/test_auth_redis_service.py::TestCache::test_cache_set PASSED  [ 22%]
tests/unit/test_auth_redis_service.py::TestCache::test_cache_get_exists PASSED [ 22%]
tests/unit/test_auth_redis_service.py::TestCache::test_cache_get_not_exists PASSED [ 22%]
tests/unit/test_auth_redis_service.py::TestCache::test_cache_delete PASSED [ 22%]
tests/unit/test_auth_redis_service.py::TestGlobalInstance::test_init_redis_service PASSED [ 22%]
tests/unit/test_auth_redis_service.py::TestGlobalInstance::test_get_redis_service FAILED [ 22%]
tests/unit/test_auth_routes.py::TestRegister::test_register_success PASSED [ 22%]
tests/unit/test_auth_routes.py::TestRegister::test_register_user_already_exists PASSED [ 22%]
tests/unit/test_auth_routes.py::TestRegister::test_register_weak_password PASSED [ 22%]
tests/unit/test_auth_routes.py::TestRegister::test_register_breached_password PASSED [ 23%]
tests/unit/test_auth_routes.py::TestRegister::test_register_rate_limited PASSED [ 23%]
tests/unit/test_auth_routes.py::TestVerifyEmail::test_verify_email_success PASSED [ 23%]
tests/unit/test_auth_routes.py::TestVerifyEmail::test_verify_email_invalid_code_redis PASSED [ 23%]
tests/unit/test_auth_routes.py::TestVerifyEmail::test_verify_email_invalid_code_database PASSED [ 23%]
tests/unit/test_auth_routes.py::TestVerifyEmail::test_verify_email_user_not_found PASSED [ 23%]
tests/unit/test_auth_routes.py::TestLogin::test_login_success PASSED     [ 23%]
tests/unit/test_auth_routes.py::TestLogin::test_login_invalid_credentials PASSED [ 23%]
tests/unit/test_auth_routes.py::TestLogin::test_login_user_not_found PASSED [ 23%]
tests/unit/test_auth_routes.py::TestLogin::test_login_account_locked PASSED [ 23%]
tests/unit/test_auth_routes.py::TestLogin::test_login_email_not_verified PASSED [ 24%]
tests/unit/test_auth_routes.py::TestLogin::test_login_requires_2fa PASSED [ 24%]
tests/unit/test_auth_routes.py::TestLogin::test_login_failed_attempts_lockout PASSED [ 24%]
tests/unit/test_auth_routes.py::TestLogin::test_login_rate_limited PASSED [ 24%]
tests/unit/test_auth_routes.py::TestLogout::test_logout_success PASSED   [ 24%]
tests/unit/test_auth_routes.py::TestLogout::test_logout_everywhere PASSED [ 24%]
tests/unit/test_auth_routes.py::TestLogout::test_logout_no_token PASSED  [ 24%]
tests/unit/test_auth_routes.py::TestLogout::test_logout_invalid_token PASSED [ 24%]
tests/unit/test_auth_routes.py::TestRefreshToken::test_refresh_token_success PASSED [ 24%]
tests/unit/test_auth_routes.py::TestRefreshToken::test_refresh_token_from_cookie PASSED [ 24%]
tests/unit/test_auth_routes.py::TestRefreshToken::test_refresh_token_no_token PASSED [ 24%]
tests/unit/test_auth_routes.py::TestRefreshToken::test_refresh_token_invalid PASSED [ 25%]
tests/unit/test_auth_routes.py::TestRefreshToken::test_refresh_token_blacklisted PASSED [ 25%]
tests/unit/test_auth_routes.py::TestRefreshToken::test_refresh_token_reuse_detection PASSED [ 25%]
tests/unit/test_auth_routes.py::TestRefreshToken::test_refresh_token_inactive_user PASSED [ 25%]
tests/unit/test_auth_routes.py::TestGetCurrentUser::test_get_me_success PASSED [ 25%]
tests/unit/test_auth_routes.py::TestGetCurrentUser::test_get_me_no_token PASSED [ 25%]
tests/unit/test_auth_routes.py::TestGetCurrentUser::test_get_me_invalid_token PASSED [ 25%]
tests/unit/test_auth_routes.py::TestGetCurrentUser::test_get_me_user_not_found PASSED [ 25%]
tests/unit/test_auth_routes.py::TestPasswordReset::test_request_password_reset_success PASSED [ 25%]
tests/unit/test_auth_routes.py::TestPasswordReset::test_request_password_reset_user_not_found PASSED [ 25%]
tests/unit/test_auth_routes.py::TestPasswordReset::test_request_password_reset_rate_limited PASSED [ 25%]
tests/unit/test_auth_routes.py::TestPasswordReset::test_confirm_password_reset_success PASSED [ 26%]
tests/unit/test_auth_routes.py::TestPasswordReset::test_confirm_password_reset_invalid_token PASSED [ 26%]
tests/unit/test_auth_routes.py::TestPasswordReset::test_confirm_password_reset_weak_password PASSED [ 26%]
tests/unit/test_auth_routes.py::TestSessions::test_list_sessions PASSED  [ 26%]
tests/unit/test_auth_routes.py::TestTwoFactorAuth::test_request_email_verification PASSED [ 26%]
tests/unit/test_auth_routes.py::TestTwoFactorAuth::test_enable_2fa PASSED [ 26%]
tests/unit/test_auth_routes.py::TestTwoFactorAuth::test_disable_2fa PASSED [ 26%]
tests/unit/test_auth_routes.py::TestHelperFunctions::test_log_audit_event PASSED [ 26%]
tests/unit/test_auth_routes.py::TestHelperFunctions::test_create_session_record PASSED [ 26%]
tests/unit/test_auth_routes.py::TestSchemas::test_register_request_validation PASSED [ 26%]
tests/unit/test_auth_routes.py::TestSchemas::test_login_request_validation PASSED [ 27%]
tests/unit/test_auth_routes.py::TestSchemas::test_password_reset_request_validation PASSED [ 27%]
tests/unit/test_auth_routes.py::TestSchemas::test_logout_request_defaults PASSED [ 27%]
tests/unit/test_auth_routes.py::TestAuthFlows::test_complete_registration_flow PASSED [ 27%]
tests/unit/test_auth_routes.py::TestAuthFlows::test_complete_password_reset_flow PASSED [ 27%]
tests/unit/test_auth_security.py::TestPasswordHashing::test_hash_password PASSED [ 27%]
tests/unit/test_auth_security.py::TestPasswordHashing::test_verify_password_correct PASSED [ 27%]
tests/unit/test_auth_security.py::TestPasswordHashing::test_verify_password_incorrect PASSED [ 27%]
tests/unit/test_auth_security.py::TestPasswordHashing::test_needs_rehash PASSED [ 27%]
tests/unit/test_auth_security.py::TestOTPGeneration::test_generate_otp_default_length PASSED [ 27%]
tests/unit/test_auth_security.py::TestOTPGeneration::test_generate_otp_custom_length PASSED [ 27%]
tests/unit/test_auth_security.py::TestOTPGeneration::test_generate_otp_uniqueness PASSED [ 28%]
tests/unit/test_auth_security.py::TestTokenGeneration::test_generate_secure_token_default PASSED [ 28%]
tests/unit/test_auth_security.py::TestTokenGeneration::test_generate_secure_token_custom_length PASSED [ 28%]
tests/unit/test_auth_security.py::TestTokenGeneration::test_hash_token PASSED [ 28%]
tests/unit/test_auth_security.py::TestTOTPEncryption::test_get_encryption_key PASSED [ 28%]
tests/unit/test_auth_security.py::TestTOTPEncryption::test_encrypt_decrypt_totp_secret PASSED [ 28%]
tests/unit/test_auth_security.py::TestTOTPEncryption::test_encrypt_totp_secret_exception PASSED [ 28%]
tests/unit/test_auth_security.py::TestTOTPEncryption::test_decrypt_totp_secret_exception PASSED [ 28%]
tests/unit/test_auth_security.py::TestTOTPEncryption::test_generate_totp_secret PASSED [ 28%]
tests/unit/test_auth_security.py::TestTOTPEncryption::test_get_totp_provisioning_uri PASSED [ 28%]
tests/unit/test_auth_security.py::TestTOTPEncryption::test_generate_qr_code PASSED [ 28%]
tests/unit/test_auth_security.py::TestTOTPEncryption::test_verify_totp_correct PASSED [ 29%]
tests/unit/test_auth_security.py::TestTOTPEncryption::test_verify_totp_incorrect PASSED [ 29%]
tests/unit/test_auth_security.py::TestBackupCodes::test_generate_backup_codes_default PASSED [ 29%]
tests/unit/test_auth_security.py::TestBackupCodes::test_generate_backup_codes_custom PASSED [ 29%]
tests/unit/test_auth_security.py::TestBackupCodes::test_verify_backup_code_success PASSED [ 29%]
tests/unit/test_auth_security.py::TestBackupCodes::test_verify_backup_code_with_spaces PASSED [ 29%]
tests/unit/test_auth_security.py::TestBackupCodes::test_verify_backup_code_case_insensitive PASSED [ 29%]
tests/unit/test_auth_security.py::TestBackupCodes::test_verify_backup_code_invalid PASSED [ 29%]
tests/unit/test_auth_security.py::TestPasswordBreach::test_check_password_breach_found PASSED [ 29%]
tests/unit/test_auth_security.py::TestPasswordBreach::test_check_password_breach_not_found PASSED [ 29%]
tests/unit/test_auth_security.py::TestPasswordBreach::test_check_password_breach_api_error PASSED [ 30%]
tests/unit/test_auth_security.py::TestPasswordBreach::test_check_password_breach_non_200_response PASSED [ 30%]
tests/unit/test_auth_security.py::TestPasswordStrength::test_strong_password PASSED [ 30%]
tests/unit/test_auth_security.py::TestPasswordStrength::test_weak_password PASSED [ 30%]
tests/unit/test_auth_security.py::TestPasswordStrength::test_fair_password PASSED [ 30%]
tests/unit/test_auth_security.py::TestPasswordStrength::test_password_with_common_patterns PASSED [ 30%]
tests/unit/test_auth_security.py::TestPasswordStrength::test_password_no_lowercase PASSED [ 30%]
tests/unit/test_auth_security.py::TestPasswordStrength::test_get_strength_label PASSED [ 30%]
tests/unit/test_auth_security.py::TestDeviceFingerprinting::test_generate_device_fingerprint PASSED [ 30%]
tests/unit/test_auth_security.py::TestDeviceFingerprinting::test_device_fingerprint_consistency PASSED [ 30%]
tests/unit/test_auth_security.py::TestDeviceFingerprinting::test_device_fingerprint_different_inputs PASSED [ 30%]
tests/unit/test_auth_security.py::TestUserAgentParsing::test_parse_windows_desktop PASSED [ 31%]
tests/unit/test_auth_security.py::TestUserAgentParsing::test_parse_mac_desktop PASSED [ 31%]
tests/unit/test_auth_security.py::TestUserAgentParsing::test_parse_android_mobile PASSED [ 31%]
tests/unit/test_auth_security.py::TestUserAgentParsing::test_parse_iphone PASSED [ 31%]
tests/unit/test_auth_security.py::TestUserAgentParsing::test_parse_ipad PASSED [ 31%]
tests/unit/test_auth_security.py::TestUserAgentParsing::test_parse_linux_desktop PASSED [ 31%]
tests/unit/test_auth_security.py::TestUserAgentParsing::test_parse_unknown_device PASSED [ 31%]
tests/unit/test_auth_security.py::TestSecurityIntegration::test_complete_password_workflow PASSED [ 31%]
tests/unit/test_auth_security.py::TestSecurityIntegration::test_complete_totp_workflow PASSED [ 31%]
tests/unit/test_auth_security.py::TestSecurityIntegration::test_complete_backup_codes_workflow PASSED [ 31%]
tests/unit/test_cache.py::TestInMemoryCache::test_set_and_get PASSED     [ 31%]
tests/unit/test_cache.py::TestInMemoryCache::test_get_nonexistent_key PASSED [ 32%]
tests/unit/test_cache.py::TestInMemoryCache::test_expiration PASSED      [ 32%]
tests/unit/test_cache.py::TestInMemoryCache::test_delete PASSED          [ 32%]
tests/unit/test_cache.py::TestInMemoryCache::test_delete_nonexistent PASSED [ 32%]
tests/unit/test_cache.py::TestInMemoryCache::test_clear PASSED           [ 32%]
tests/unit/test_cache.py::TestInMemoryCache::test_exists PASSED          [ 32%]
tests/unit/test_cache.py::TestInMemoryCache::test_max_size_eviction PASSED [ 32%]
tests/unit/test_cache.py::TestInMemoryCache::test_cleanup_expired PASSED [ 32%]
tests/unit/test_cache.py::TestCacheManager::test_initialization PASSED   [ 32%]
tests/unit/test_cache.py::TestCacheManager::test_connect PASSED          [ 32%]
tests/unit/test_cache.py::TestCacheManager::test_disconnect PASSED       [ 32%]
tests/unit/test_cache.py::TestCacheManager::test_get_set_operations PASSED [ 33%]
tests/unit/test_cache.py::TestCacheManager::test_delete_operation PASSED [ 33%]
tests/unit/test_cache.py::TestCacheManager::test_clear_operation PASSED  [ 33%]
tests/unit/test_cache.py::TestCacheManager::test_get_stats PASSED        [ 33%]
tests/unit/test_cache.py::TestGlobalCacheInstance::test_get_cache PASSED [ 33%]
tests/unit/test_cache.py::TestCachedDecorator::test_cached_function PASSED [ 33%]
tests/unit/test_cache.py::TestCachedDecorator::test_cached_with_different_args PASSED [ 33%]
tests/unit/test_cache.py::TestCachedDecorator::test_cached_with_kwargs PASSED [ 33%]
tests/unit/test_cache.py::TestCachedDecorator::test_cached_with_key_prefix PASSED [ 33%]
tests/unit/test_cache.py::TestCachedDecorator::test_cached_expiration PASSED [ 33%]
tests/unit/test_cache.py::TestCacheIntegration::test_multiple_cache_operations PASSED [ 34%]
tests/unit/test_cache.py::TestCacheIntegration::test_cache_complex_data_types PASSED [ 34%]
tests/unit/test_config.py::TestSettings::test_default_settings PASSED    [ 34%]
tests/unit/test_config.py::TestSettings::test_database_url_default PASSED [ 34%]
tests/unit/test_config.py::TestSettings::test_secret_key_generation PASSED [ 34%]
tests/unit/test_config.py::TestSettings::test_cors_origins_default PASSED [ 34%]
tests/unit/test_config.py::TestSettings::test_jwt_settings PASSED        [ 34%]
tests/unit/test_config.py::TestSettings::test_password_settings PASSED   [ 34%]
tests/unit/test_config.py::TestSettings::test_rate_limiting_settings PASSED [ 34%]
tests/unit/test_config.py::TestSettings::test_feature_flags PASSED       [ 34%]
tests/unit/test_config.py::TestSettings::test_production_environment PASSED [ 34%]
tests/unit/test_config.py::TestSettings::test_test_environment PASSED    [ 35%]
tests/unit/test_config.py::TestSettings::test_debug_false PASSED         [ 35%]
tests/unit/test_config.py::TestSettings::test_custom_port PASSED         [ 35%]
tests/unit/test_config.py::TestSettings::test_custom_database_url PASSED [ 35%]
tests/unit/test_config.py::TestSettings::test_custom_secret_key PASSED   [ 35%]
tests/unit/test_config.py::TestSettings::test_custom_cors_origins PASSED [ 35%]
tests/unit/test_config.py::TestSettings::test_custom_log_level PASSED    [ 35%]
tests/unit/test_config.py::TestSettings::test_custom_workers PASSED      [ 35%]
tests/unit/test_config.py::TestSettings::test_redis_url_default PASSED   [ 35%]
tests/unit/test_config.py::TestSettings::test_custom_redis_url PASSED    [ 35%]
tests/unit/test_config.py::TestSettings::test_api_limits PASSED          [ 35%]
tests/unit/test_config.py::TestSettings::test_jwt_issuer_audience PASSED [ 36%]
tests/unit/test_config.py::TestSettings::test_custom_token_expiry PASSED [ 36%]
tests/unit/test_config.py::TestSettings::test_custom_rate_limit PASSED   [ 36%]
tests/unit/test_config.py::TestGetSettings::test_get_settings_returns_instance PASSED [ 36%]
tests/unit/test_config.py::TestGetSettings::test_get_settings_singleton PASSED [ 36%]
tests/unit/test_config.py::TestGetSettings::test_get_settings_with_env_changes PASSED [ 36%]
tests/unit/test_config.py::TestGetSettings::test_cors_origins_validator_with_string PASSED [ 36%]
tests/unit/test_config.py::TestGetSettings::test_cors_origins_validator_with_empty_string PASSED [ 36%]
tests/unit/test_config.py::TestGetSettings::test_get_settings_development_environment PASSED [ 36%]
tests/unit/test_config.py::TestGetSettings::test_get_settings_production_environment PASSED [ 36%]
tests/unit/test_config_database.py::TestConfigDatabase::test_engine_kwargs_postgresql PASSED [ 37%]
tests/unit/test_config_database.py::TestConfigDatabase::test_engine_kwargs_sqlite PASSED [ 37%]
tests/unit/test_config_database.py::TestConfigDatabase::test_database_event_listeners PASSED [ 37%]
tests/unit/test_config_database.py::TestConfigDatabase::test_get_db_success PASSED [ 37%]
tests/unit/test_config_database.py::TestConfigDatabase::test_get_db_exception_handling PASSED [ 37%]
tests/unit/test_config_database.py::TestConfigDatabase::test_init_db_creates_tables PASSED [ 37%]
tests/unit/test_config_database.py::TestConfigDatabase::test_close_db_disposes_engine PASSED [ 37%]
tests/unit/test_config_database.py::TestConfigDatabase::test_connection_event_listener PASSED [ 37%]
tests/unit/test_config_database.py::TestConfigDatabase::test_checkout_event_listener PASSED [ 37%]
tests/unit/test_config_database.py::TestConfigDatabase::test_checkin_event_listener PASSED [ 37%]
tests/unit/test_config_database.py::TestConfigDatabase::test_get_session_alias PASSED [ 37%]
tests/unit/test_database.py::TestGetDb::test_get_db_yields_session PASSED [ 38%]
tests/unit/test_database.py::TestGetDb::test_get_db_handles_exception PASSED [ 38%]
tests/unit/test_database.py::TestDatabaseManager::test_database_manager_creation PASSED [ 38%]
tests/unit/test_database.py::TestDatabaseManager::test_global_db_manager_instance PASSED [ 38%]
tests/unit/test_database.py::TestInitDb::test_init_db_success PASSED     [ 38%]
tests/unit/test_database.py::TestInitDb::test_init_db_exception PASSED   [ 38%]
tests/unit/test_database.py::TestCloseDb::test_close_db_success PASSED   [ 38%]
tests/unit/test_database.py::TestCloseDb::test_close_db_exception PASSED [ 38%]
tests/unit/test_database.py::TestHealthCheck::test_health_check_success PASSED [ 38%]
tests/unit/test_database.py::TestHealthCheck::test_health_check_failure PASSED [ 38%]
tests/unit/test_database.py::TestHealthCheck::test_health_check_query_failure PASSED [ 38%]
tests/unit/test_database.py::TestCreateDatabaseEngine::test_create_database_engine PASSED [ 39%]
tests/unit/test_database.py::TestGetDbSession::test_get_db_session_success PASSED [ 39%]
tests/unit/test_database.py::TestGetDbSession::test_get_db_session_exception PASSED [ 39%]
tests/unit/test_database.py::TestGetDbSession::test_get_db_session_not_initialized PASSED [ 39%]
tests/unit/test_database.py::TestDatabaseConfiguration::test_database_url_configuration PASSED [ 39%]
tests/unit/test_database.py::TestDatabaseConfiguration::test_sqlite_database_configuration PASSED [ 39%]
tests/unit/test_database.py::TestDatabaseModels::test_base_model_import PASSED [ 39%]
tests/unit/test_database.py::TestDatabaseModels::test_models_are_registered PASSED [ 39%]
tests/unit/test_database.py::TestDatabaseUtilities::test_database_session_context_manager PASSED [ 39%]
tests/unit/test_database.py::TestDatabaseUtilities::test_database_engine_configuration PASSED [ 39%]
tests/unit/test_database.py::TestDatabaseUtilities::test_session_factory_configuration PASSED [ 40%]
tests/unit/test_database.py::TestDatabaseErrorHandling::test_connection_error_handling PASSED [ 40%]
tests/unit/test_database.py::TestDatabaseErrorHandling::test_session_error_handling PASSED [ 40%]
tests/unit/test_database.py::TestDatabaseEventListeners::test_sqlite_pragma_setup PASSED [ 40%]
tests/unit/test_database.py::TestDatabaseEventListeners::test_connection_event_listener PASSED [ 40%]
tests/unit/test_database.py::TestDatabaseEventListeners::test_checkout_event_listener PASSED [ 40%]
tests/unit/test_database.py::TestDatabaseEventListeners::test_checkin_event_listener PASSED [ 40%]
tests/unit/test_database.py::TestDatabaseManagerMethods::test_execute_raw_sql PASSED [ 40%]
tests/unit/test_database.py::TestDatabaseManagerMethods::test_get_connection_info_not_connected PASSED [ 40%]
tests/unit/test_database.py::TestDatabaseManagerMethods::test_get_connection_info_connected PASSED [ 40%]
tests/unit/test_database.py::TestDatabaseManagerMethods::test_vacuum_analyze_postgresql PASSED [ 40%]
tests/unit/test_database.py::TestDatabaseManagerMethods::test_vacuum_analyze_sqlite_skipped PASSED [ 41%]
tests/unit/test_database_compat.py::TestVectorField::test_initialization PASSED [ 41%]
tests/unit/test_database_compat.py::TestVectorField::test_default_dimensions PASSED [ 41%]
tests/unit/test_database_compat.py::TestVectorField::test_load_dialect_impl_postgresql PASSED [ 41%]
tests/unit/test_database_compat.py::TestVectorField::test_load_dialect_impl_postgresql_no_pgvector PASSED [ 41%]
tests/unit/test_database_compat.py::TestVectorField::test_load_dialect_impl_sqlite PASSED [ 41%]
tests/unit/test_database_compat.py::TestVectorField::test_process_bind_param_none PASSED [ 41%]
tests/unit/test_database_compat.py::TestVectorField::test_process_bind_param_sqlite PASSED [ 41%]
tests/unit/test_database_compat.py::TestVectorField::test_process_bind_param_postgresql_with_pgvector PASSED [ 41%]
tests/unit/test_database_compat.py::TestVectorField::test_process_bind_param_postgresql_no_pgvector PASSED [ 41%]
tests/unit/test_database_compat.py::TestVectorField::test_process_result_value_none PASSED [ 41%]
tests/unit/test_database_compat.py::TestVectorField::test_process_result_value_sqlite_string PASSED [ 42%]
tests/unit/test_database_compat.py::TestVectorField::test_process_result_value_sqlite_list PASSED [ 42%]
tests/unit/test_database_compat.py::TestVectorField::test_process_result_value_postgresql_list PASSED [ 42%]
tests/unit/test_database_compat.py::TestVectorField::test_process_result_value_postgresql_string PASSED [ 42%]
tests/unit/test_database_compat.py::TestVectorField::test_process_result_value_postgresql_import_error_string PASSED [ 42%]
tests/unit/test_database_compat.py::TestVectorField::test_process_result_value_postgresql_import_error_value PASSED [ 42%]
tests/unit/test_database_compat.py::TestVectorField::test_process_result_value_postgresql_other_type PASSED [ 42%]
tests/unit/test_database_compat.py::TestGetVectorColumn::test_default_dimensions PASSED [ 42%]
tests/unit/test_database_compat.py::TestGetVectorColumn::test_custom_dimensions PASSED [ 42%]
tests/unit/test_database_compat.py::TestCalculateCosineSimilarity::test_identical_vectors PASSED [ 42%]
tests/unit/test_database_compat.py::TestCalculateCosineSimilarity::test_orthogonal_vectors PASSED [ 42%]
tests/unit/test_database_compat.py::TestCalculateCosineSimilarity::test_opposite_vectors PASSED [ 43%]
tests/unit/test_database_compat.py::TestCalculateCosineSimilarity::test_empty_vectors PASSED [ 43%]
tests/unit/test_database_compat.py::TestCalculateCosineSimilarity::test_none_vectors PASSED [ 43%]
tests/unit/test_database_compat.py::TestCalculateCosineSimilarity::test_different_length_vectors PASSED [ 43%]
tests/unit/test_database_compat.py::TestCalculateCosineSimilarity::test_zero_magnitude_vector PASSED [ 43%]
tests/unit/test_database_compat.py::TestCalculateCosineSimilarity::test_similar_vectors PASSED [ 43%]
tests/unit/test_database_compat.py::TestGetDatabaseType::test_postgresql_url PASSED [ 43%]
tests/unit/test_database_compat.py::TestGetDatabaseType::test_postgres_url PASSED [ 43%]
tests/unit/test_database_compat.py::TestGetDatabaseType::test_sqlite_url PASSED [ 43%]
tests/unit/test_database_compat.py::TestGetDatabaseType::test_mysql_url PASSED [ 43%]
tests/unit/test_database_compat.py::TestGetDatabaseType::test_unknown_url PASSED [ 44%]
tests/unit/test_database_compat.py::TestIsVectorSearchSupported::test_postgresql_with_pgvector PASSED [ 44%]
tests/unit/test_database_compat.py::TestIsVectorSearchSupported::test_postgresql_without_pgvector PASSED [ 44%]
tests/unit/test_database_compat.py::TestIsVectorSearchSupported::test_sqlite_no_support PASSED [ 44%]
tests/unit/test_database_compat.py::TestIsVectorSearchSupported::test_mysql_no_support PASSED [ 44%]
tests/unit/test_database_compat.py::TestValidateVectorDimensions::test_valid_vector_default_dimensions PASSED [ 44%]
tests/unit/test_database_compat.py::TestValidateVectorDimensions::test_valid_vector_custom_dimensions PASSED [ 44%]
tests/unit/test_database_compat.py::TestValidateVectorDimensions::test_invalid_vector_wrong_dimensions PASSED [ 44%]
tests/unit/test_database_compat.py::TestValidateVectorDimensions::test_invalid_vector_not_list PASSED [ 44%]
tests/unit/test_database_compat.py::TestValidateVectorDimensions::test_invalid_vector_non_numeric_elements PASSED [ 44%]
tests/unit/test_database_compat.py::TestValidateVectorDimensions::test_empty_vector PASSED [ 44%]
tests/unit/test_database_compat.py::TestValidateVectorDimensions::test_vector_with_integers PASSED [ 45%]
tests/unit/test_database_compat.py::TestNormalizeVector::test_normalize_unit_vector PASSED [ 45%]
tests/unit/test_database_compat.py::TestNormalizeVector::test_normalize_regular_vector PASSED [ 45%]
tests/unit/test_database_compat.py::TestNormalizeVector::test_normalize_empty_vector PASSED [ 45%]
tests/unit/test_database_compat.py::TestNormalizeVector::test_normalize_zero_vector PASSED [ 45%]
tests/unit/test_database_compat.py::TestNormalizeVector::test_normalized_vector_has_unit_length PASSED [ 45%]
tests/unit/test_database_compat.py::TestDatabaseCompatibilityError::test_exception_creation PASSED [ 45%]
tests/unit/test_database_compat.py::TestDatabaseCompatibilityError::test_exception_raising PASSED [ 45%]
tests/unit/test_database_compat.py::TestIntegration::test_vector_workflow PASSED [ 45%]
tests/unit/test_database_compat.py::TestIntegration::test_database_detection PASSED [ 45%]
tests/unit/test_email_service.py::TestEmailService::test_email_service_initialization PASSED [ 45%]
tests/unit/test_email_service.py::TestEmailService::test_send_email_success PASSED [ 46%]
tests/unit/test_email_service.py::TestEmailService::test_send_email_without_text_content PASSED [ 46%]
tests/unit/test_email_service.py::TestEmailService::test_send_email_failure PASSED [ 46%]
tests/unit/test_email_service.py::TestEmailService::test_send_verification_code_success PASSED [ 46%]
tests/unit/test_email_service.py::TestEmailService::test_send_verification_code_without_username PASSED [ 46%]
tests/unit/test_email_service.py::TestEmailService::test_send_password_reset_success PASSED [ 46%]
tests/unit/test_email_service.py::TestEmailService::test_send_password_reset_without_username PASSED [ 46%]
tests/unit/test_email_service.py::TestEmailService::test_send_password_changed_notification_success PASSED [ 46%]
tests/unit/test_email_service.py::TestEmailService::test_send_password_changed_notification_without_username PASSED [ 46%]
tests/unit/test_email_service.py::TestEmailService::test_send_welcome_email_success PASSED [ 46%]
tests/unit/test_email_service.py::TestEmailService::test_send_welcome_email_without_username PASSED [ 47%]
tests/unit/test_email_service.py::TestGlobalEmailService::test_init_email_service PASSED [ 47%]
tests/unit/test_email_service.py::TestGlobalEmailService::test_get_email_service_success PASSED [ 47%]
tests/unit/test_email_service.py::TestGlobalEmailService::test_get_email_service_not_initialized PASSED [ 47%]
tests/unit/test_email_service.py::TestEmailContentGeneration::test_verification_code_email_contains_code PASSED [ 47%]
tests/unit/test_email_service.py::TestEmailContentGeneration::test_password_reset_email_contains_link PASSED [ 47%]
tests/unit/test_email_service.py::TestEmailContentGeneration::test_welcome_email_contains_frontend_url PASSED [ 47%]
tests/unit/test_endpoints_analytics.py::TestAnalyticsEndpoints::test_get_analytics PASSED [ 47%]
tests/unit/test_endpoints_analytics.py::TestAnalyticsEndpoints::test_get_analytics_overview PASSED [ 47%]
tests/unit/test_endpoints_analytics.py::TestAnalyticsEndpoints::test_get_traffic_stats_no_dates PASSED [ 47%]
tests/unit/test_endpoints_analytics.py::TestAnalyticsEndpoints::test_get_traffic_stats_with_dates PASSED [ 47%]
tests/unit/test_endpoints_analytics.py::TestAnalyticsEndpoints::test_get_user_engagement PASSED [ 48%]
tests/unit/test_endpoints_analytics.py::TestAnalyticsEndpoints::test_get_popular_content_default PASSED [ 48%]
tests/unit/test_endpoints_analytics.py::TestAnalyticsEndpoints::test_get_popular_content_custom_limit PASSED [ 48%]
tests/unit/test_endpoints_analytics.py::TestAnalyticsEndpoints::test_export_analytics_csv PASSED [ 48%]
tests/unit/test_endpoints_analytics.py::TestAnalyticsEndpoints::test_export_analytics_json PASSED [ 48%]
tests/unit/test_endpoints_analytics.py::TestAnalyticsEndpoints::test_export_analytics_pdf PASSED [ 48%]
tests/unit/test_endpoints_analytics.py::TestAnalyticsEndpoints::test_get_realtime_stats PASSED [ 48%]
tests/unit/test_endpoints_chat.py::TestChatEndpoints::test_chat_feature_disabled PASSED [ 48%]
tests/unit/test_endpoints_chat.py::TestChatEndpoints::test_chat_success PASSED [ 48%]
tests/unit/test_endpoints_chat.py::TestChatEndpoints::test_chat_with_context PASSED [ 48%]
tests/unit/test_endpoints_chat.py::TestChatEndpoints::test_generate_image_feature_disabled PASSED [ 48%]
tests/unit/test_endpoints_chat.py::TestChatEndpoints::test_generate_image_success PASSED [ 49%]
tests/unit/test_endpoints_chat.py::TestChatEndpoints::test_get_available_models PASSED [ 49%]
tests/unit/test_endpoints_chat.py::TestChatEndpoints::test_get_chat_history PASSED [ 49%]
tests/unit/test_endpoints_chat.py::TestChatEndpoints::test_get_conversation PASSED [ 49%]
tests/unit/test_endpoints_chat.py::TestChatEndpoints::test_delete_conversation PASSED [ 49%]
tests/unit/test_endpoints_chat.py::TestChatValidation::test_chat_message_validation PASSED [ 49%]
tests/unit/test_endpoints_chat.py::TestChatValidation::test_chat_request_validation PASSED [ 49%]
tests/unit/test_endpoints_chat.py::TestChatValidation::test_image_request_validation PASSED [ 49%]
tests/unit/test_endpoints_files.py::TestFileEndpoints::test_upload_file_success PASSED [ 49%]
tests/unit/test_endpoints_files.py::TestFileEndpoints::test_upload_file_error PASSED [ 49%]
tests/unit/test_endpoints_files.py::TestFileEndpoints::test_list_files PASSED [ 50%]
tests/unit/test_endpoints_files.py::TestFileEndpoints::test_download_file_success PASSED [ 50%]
tests/unit/test_endpoints_files.py::TestFileEndpoints::test_download_file_not_found PASSED [ 50%]
tests/unit/test_endpoints_files.py::TestFileEndpoints::test_delete_file_success PASSED [ 50%]
tests/unit/test_endpoints_files.py::TestFileEndpoints::test_delete_file_not_found PASSED [ 50%]
tests/unit/test_endpoints_search.py::TestSearchEndpoints::test_search_all_types PASSED [ 50%]
tests/unit/test_endpoints_search.py::TestSearchEndpoints::test_search_users_only PASSED [ 50%]
tests/unit/test_endpoints_search.py::TestSearchEndpoints::test_search_posts_only PASSED [ 50%]
tests/unit/test_endpoints_search.py::TestSearchEndpoints::test_search_files_only PASSED [ 50%]
tests/unit/test_endpoints_search.py::TestSearchEndpoints::test_search_with_pagination PASSED [ 50%]
tests/unit/test_endpoints_search.py::TestSearchEndpoints::test_search_with_sorting PASSED [ 50%]
tests/unit/test_endpoints_search.py::TestSearchEndpoints::test_autocomplete PASSED [ 51%]
tests/unit/test_endpoints_search.py::TestSearchEndpoints::test_autocomplete_with_limit PASSED [ 51%]
tests/unit/test_endpoints_search.py::TestSearchEndpoints::test_get_filters PASSED [ 51%]
tests/unit/test_endpoints_search.py::TestSearchTypes::test_search_type_values PASSED [ 51%]
tests/unit/test_exceptions.py::TestAPIException::test_api_exception_default PASSED [ 51%]
tests/unit/test_exceptions.py::TestAPIException::test_api_exception_custom PASSED [ 51%]
tests/unit/test_exceptions.py::TestAPIException::test_api_exception_to_dict PASSED [ 51%]
tests/unit/test_exceptions.py::TestValidationException::test_validation_exception_default PASSED [ 51%]
tests/unit/test_exceptions.py::TestValidationException::test_validation_exception_with_field_errors PASSED [ 51%]
tests/unit/test_exceptions.py::TestAuthenticationException::test_authentication_exception_default PASSED [ 51%]
tests/unit/test_exceptions.py::TestAuthenticationException::test_authentication_exception_custom PASSED [ 51%]
tests/unit/test_exceptions.py::TestAuthorizationException::test_authorization_exception_default PASSED [ 52%]
tests/unit/test_exceptions.py::TestAuthorizationException::test_authorization_exception_custom PASSED [ 52%]
tests/unit/test_exceptions.py::TestNotFoundException::test_not_found_exception_default PASSED [ 52%]
tests/unit/test_exceptions.py::TestNotFoundException::test_not_found_exception_custom PASSED [ 52%]
tests/unit/test_exceptions.py::TestConflictException::test_conflict_exception_default PASSED [ 52%]
tests/unit/test_exceptions.py::TestConflictException::test_conflict_exception_custom PASSED [ 52%]
tests/unit/test_exceptions.py::TestRateLimitException::test_rate_limit_exception_default PASSED [ 52%]
tests/unit/test_exceptions.py::TestRateLimitException::test_rate_limit_exception_with_retry_after PASSED [ 52%]
tests/unit/test_exceptions.py::TestExternalServiceException::test_external_service_exception_default PASSED [ 52%]
tests/unit/test_exceptions.py::TestExternalServiceException::test_external_service_exception_custom PASSED [ 52%]
tests/unit/test_exceptions.py::TestDatabaseException::test_database_exception_default PASSED [ 52%]
tests/unit/test_exceptions.py::TestDatabaseException::test_database_exception_custom PASSED [ 53%]
tests/unit/test_exceptions.py::TestCacheException::test_cache_exception_default PASSED [ 53%]
tests/unit/test_exceptions.py::TestCacheException::test_cache_exception_custom PASSED [ 53%]
tests/unit/test_exceptions.py::TestResponseHelpers::test_create_error_response_default PASSED [ 53%]
tests/unit/test_exceptions.py::TestResponseHelpers::test_create_error_response_custom PASSED [ 53%]
tests/unit/test_exceptions.py::TestResponseHelpers::test_create_success_response_default PASSED [ 53%]
tests/unit/test_exceptions.py::TestResponseHelpers::test_create_success_response_with_data PASSED [ 53%]
tests/unit/test_exceptions.py::TestResponseHelpers::test_create_success_response_with_meta PASSED [ 53%]
tests/unit/test_exceptions.py::TestResponseHelpers::test_create_success_response_none_data PASSED [ 53%]
tests/unit/test_exceptions.py::TestExceptionHandlers::test_api_exception_handler PASSED [ 53%]
tests/unit/test_exceptions.py::TestExceptionHandlers::test_validation_exception_handler PASSED [ 54%]
tests/unit/test_exceptions.py::TestExceptionHandlers::test_authentication_exception_handler PASSED [ 54%]
tests/unit/test_exceptions.py::TestExceptionHandlers::test_authorization_exception_handler PASSED [ 54%]
tests/unit/test_exceptions.py::TestExceptionHandlers::test_rate_limit_exception_handler PASSED [ 54%]
tests/unit/test_exceptions.py::TestExceptionHandlers::test_general_exception_handler PASSED [ 54%]
tests/unit/test_file_service.py::TestFileServiceInitialization::test_file_service_initialization PASSED [ 54%]
tests/unit/test_file_service.py::TestFileServiceInitialization::test_allowed_extensions_structure PASSED [ 54%]
tests/unit/test_file_service.py::TestUploadFile::test_upload_file_success_image PASSED [ 54%]
tests/unit/test_file_service.py::TestUploadFile::test_upload_file_success_document PASSED [ 54%]
tests/unit/test_file_service.py::TestUploadFile::test_upload_file_with_allowed_types PASSED [ 54%]
tests/unit/test_file_service.py::TestUploadFile::test_upload_file_creates_directory_structure PASSED [ 54%]
tests/unit/test_file_service.py::TestUploadFile::test_upload_file_generates_unique_filename PASSED [ 55%]
tests/unit/test_file_service.py::TestDeleteFile::test_delete_file_success PASSED [ 55%]
tests/unit/test_file_service.py::TestDeleteFile::test_delete_file_not_found PASSED [ 55%]
tests/unit/test_file_service.py::TestDeleteFile::test_delete_file_exception_handled PASSED [ 55%]
tests/unit/test_file_service.py::TestValidateFile::test_validate_file_no_filename PASSED [ 55%]
tests/unit/test_file_service.py::TestValidateFile::test_validate_file_empty_filename PASSED [ 55%]
tests/unit/test_file_service.py::TestValidateFile::test_validate_file_exceeds_size_limit PASSED [ 55%]
tests/unit/test_file_service.py::TestValidateFile::test_validate_file_allowed_extension PASSED [ 55%]
tests/unit/test_file_service.py::TestValidateFile::test_validate_file_disallowed_extension PASSED [ 55%]
tests/unit/test_file_service.py::TestValidateFile::test_validate_file_with_allowed_types_success PASSED [ 55%]
tests/unit/test_file_service.py::TestValidateFile::test_validate_file_with_allowed_types_failure PASSED [ 55%]
tests/unit/test_file_service.py::TestValidateFile::test_validate_file_multiple_allowed_types PASSED [ 56%]
tests/unit/test_file_service.py::TestValidateFile::test_validate_file_case_insensitive_extension PASSED [ 56%]
tests/unit/test_file_service.py::TestGetFileType::test_get_file_type_image PASSED [ 56%]
tests/unit/test_file_service.py::TestGetFileType::test_get_file_type_document PASSED [ 56%]
tests/unit/test_file_service.py::TestGetFileType::test_get_file_type_video PASSED [ 56%]
tests/unit/test_file_service.py::TestGetFileType::test_get_file_type_audio PASSED [ 56%]
tests/unit/test_file_service.py::TestGetFileType::test_get_file_type_archive PASSED [ 56%]
tests/unit/test_file_service.py::TestGetFileType::test_get_file_type_unknown PASSED [ 56%]
tests/unit/test_file_service.py::TestGetFileType::test_get_file_type_case_insensitive PASSED [ 56%]
tests/unit/test_file_service.py::TestGetFileType::test_get_file_type_no_extension PASSED [ 56%]
tests/unit/test_file_service.py::TestFileServiceEdgeCases::test_upload_file_with_special_characters PASSED [ 57%]
tests/unit/test_file_service.py::TestFileServiceEdgeCases::test_validate_file_exact_size_limit PASSED [ 57%]
tests/unit/test_file_service.py::TestFileServiceEdgeCases::test_validate_file_one_byte_over_limit PASSED [ 57%]
tests/unit/test_file_service.py::TestFileServiceEdgeCases::test_upload_different_users_same_folder PASSED [ 57%]
tests/unit/test_file_service.py::TestFileServiceEdgeCases::test_get_file_type_with_multiple_dots PASSED [ 57%]
tests/unit/test_health_endpoints.py::TestHealthEndpoints::test_health_check_basic PASSED [ 57%]
tests/unit/test_health_endpoints.py::TestHealthEndpoints::test_readiness_check_healthy PASSED [ 57%]
tests/unit/test_health_endpoints.py::TestHealthEndpoints::test_readiness_check_database_unhealthy PASSED [ 57%]
tests/unit/test_health_endpoints.py::TestHealthEndpoints::test_readiness_check_redis_unhealthy PASSED [ 57%]
tests/unit/test_health_endpoints.py::TestHealthEndpoints::test_readiness_check_with_ai_service PASSED [ 57%]
tests/unit/test_health_endpoints.py::TestHealthEndpoints::test_readiness_check_ai_service_exception PASSED [ 57%]
tests/unit/test_health_endpoints.py::TestHealthEndpoints::test_readiness_check_exception_handling PASSED [ 58%]
tests/unit/test_health_endpoints.py::TestHealthEndpoints::test_liveness_check PASSED [ 58%]
tests/unit/test_health_endpoints.py::TestHealthEndpoints::test_detailed_health_check_success PASSED [ 58%]
tests/unit/test_health_endpoints.py::TestHealthEndpoints::test_detailed_health_check_database_error PASSED [ 58%]
tests/unit/test_health_endpoints.py::TestHealthEndpoints::test_detailed_health_check_redis_error PASSED [ 58%]
tests/unit/test_health_endpoints.py::TestHealthEndpoints::test_detailed_health_check_no_psutil PASSED [ 58%]
tests/unit/test_health_endpoints.py::TestHealthRouterConfiguration::test_router_exists PASSED [ 58%]
tests/unit/test_health_endpoints.py::TestHealthRouterConfiguration::test_router_endpoints PASSED [ 58%]
tests/unit/test_health_endpoints.py::TestHealthRouterConfiguration::test_router_methods PASSED [ 58%]
tests/unit/test_health_endpoints.py::TestHealthEndpointIntegration::test_health_check_performance PASSED [ 58%]
tests/unit/test_health_endpoints.py::TestHealthEndpointIntegration::test_health_endpoints_return_consistent_format PASSED [ 58%]
tests/unit/test_health_endpoints.py::TestHealthEndpointIntegration::test_health_endpoints_include_timestamps PASSED [ 59%]
tests/unit/test_health_endpoints.py::TestHealthEndpointIntegration::test_health_endpoints_include_version_info PASSED [ 59%]
tests/unit/test_health_endpoints.py::TestHealthEndpointIntegration::test_health_detailed_ai_service_exception PASSED [ 59%]
tests/unit/test_jwks_routes.py::TestGetJWKS::test_get_jwks_success PASSED [ 59%]
tests/unit/test_jwks_routes.py::TestGetOpenIDConfiguration::test_get_openid_configuration PASSED [ 59%]
tests/unit/test_jwt_utils.py::TestJWTManager::test_verify_token_invalid_type PASSED [ 59%]
tests/unit/test_jwt_utils.py::TestJWTManager::test_verify_token_expired PASSED [ 59%]
tests/unit/test_jwt_utils.py::TestJWTManager::test_get_jwks PASSED       [ 59%]
tests/unit/test_jwt_utils.py::TestJWTManager::test_decode_token_unsafe_success PASSED [ 59%]
tests/unit/test_jwt_utils.py::TestJWTManager::test_decode_token_unsafe_invalid PASSED [ 59%]
tests/unit/test_jwt_utils.py::TestJWTManagerKeyLoading::test_load_keys_from_file PASSED [ 60%]
tests/unit/test_jwt_utils.py::TestJWTManagerKeyLoading::test_load_keys_exception_handling PASSED [ 60%]
tests/unit/test_jwt_utils.py::TestJWTManagerGlobalInstance::test_init_jwt_manager PASSED [ 60%]
tests/unit/test_jwt_utils.py::TestJWTManagerGlobalInstance::test_get_jwt_manager PASSED [ 60%]
tests/unit/test_logging.py::TestStructuredLogger::test_structured_logger_creation PASSED [ 60%]
tests/unit/test_logging.py::TestStructuredLogger::test_bind_context PASSED [ 60%]
tests/unit/test_logging.py::TestStructuredLogger::test_bind_multiple_contexts PASSED [ 60%]
tests/unit/test_logging.py::TestStructuredLogger::test_format_message_no_context PASSED [ 60%]
tests/unit/test_logging.py::TestStructuredLogger::test_format_message_with_context PASSED [ 60%]
tests/unit/test_logging.py::TestStructuredLogger::test_format_message_with_kwargs PASSED [ 60%]
tests/unit/test_logging.py::TestStructuredLogger::test_debug_logging PASSED [ 60%]
tests/unit/test_logging.py::TestStructuredLogger::test_info_logging PASSED [ 61%]
tests/unit/test_logging.py::TestStructuredLogger::test_warning_logging PASSED [ 61%]
tests/unit/test_logging.py::TestStructuredLogger::test_error_logging PASSED [ 61%]
tests/unit/test_logging.py::TestStructuredLogger::test_critical_logging PASSED [ 61%]
tests/unit/test_logging.py::TestGetLogger::test_get_logger_returns_structured_logger PASSED [ 61%]
tests/unit/test_logging.py::TestGetLogger::test_get_logger_different_names PASSED [ 61%]
tests/unit/test_logging.py::TestSetupLogging::test_setup_logging_default PASSED [ 61%]
tests/unit/test_logging.py::TestSetupLogging::test_setup_logging_custom_level PASSED [ 61%]
tests/unit/test_logging.py::TestSetupLogging::test_setup_logging_invalid_level PASSED [ 61%]
tests/unit/test_logging.py::TestLogRequestHelpers::test_log_request_start PASSED [ 61%]
tests/unit/test_logging.py::TestLogRequestHelpers::test_log_request_end PASSED [ 61%]
tests/unit/test_logging.py::TestLogRequestHelpers::test_log_database_operation PASSED [ 62%]
tests/unit/test_logging.py::TestLogRequestHelpers::test_log_cache_operation PASSED [ 62%]
tests/unit/test_logging.py::TestLogRequestHelpers::test_log_external_api_call PASSED [ 62%]
tests/unit/test_logging.py::TestPerformanceLogger::test_performance_logger_creation PASSED [ 62%]
tests/unit/test_logging.py::TestPerformanceLogger::test_log_slow_query PASSED [ 62%]
tests/unit/test_logging.py::TestPerformanceLogger::test_log_slow_query_truncation PASSED [ 62%]
tests/unit/test_logging.py::TestPerformanceLogger::test_log_memory_usage_below_threshold PASSED [ 62%]
tests/unit/test_logging.py::TestPerformanceLogger::test_log_memory_usage_above_threshold PASSED [ 62%]
tests/unit/test_logging.py::TestPerformanceLogger::test_log_response_time_below_threshold PASSED [ 62%]
tests/unit/test_logging.py::TestPerformanceLogger::test_log_response_time_above_threshold PASSED [ 62%]
tests/unit/test_logging.py::TestGlobalPerformanceLogger::test_performance_logger_instance PASSED [ 62%]
tests/unit/test_logging.py::TestGlobalPerformanceLogger::test_performance_logger_methods_available PASSED [ 63%]
tests/unit/test_main.py::TestApplicationLifespan::test_lifespan_startup_success PASSED [ 63%]
tests/unit/test_main.py::TestApplicationLifespan::test_lifespan_startup_failure PASSED [ 63%]
tests/unit/test_main.py::TestApplicationLifespan::test_lifespan_shutdown_error PASSED [ 63%]
tests/unit/test_main.py::TestApplicationLifespan::test_lifespan_with_metrics_enabled PASSED [ 63%]
tests/unit/test_main.py::TestCreateApp::test_create_app_returns_fastapi_instance PASSED [ 63%]
tests/unit/test_main.py::TestCreateApp::test_create_app_with_debug_disabled PASSED [ 63%]
tests/unit/test_main.py::TestApplicationEndpoints::test_root_endpoint PASSED [ 63%]
tests/unit/test_main.py::TestApplicationEndpoints::test_health_endpoint PASSED [ 63%]
tests/unit/test_main.py::TestApplicationEndpoints::test_stats_endpoint PASSED [ 63%]
tests/unit/test_main.py::TestApplicationEndpoints::test_ready_endpoint PASSED [ 64%]
tests/unit/test_main.py::TestApplicationConfiguration::test_app_with_metrics_enabled PASSED [ 64%]
tests/unit/test_main.py::TestApplicationConfiguration::test_app_includes_routers PASSED [ 64%]
tests/unit/test_main.py::TestApplicationConfiguration::test_app_has_cors_middleware PASSED [ 64%]
tests/unit/test_main.py::TestApplicationConfiguration::test_app_has_exception_handlers PASSED [ 64%]
tests/unit/test_middleware.py::TestSecurityHeadersMiddleware::test_security_headers_added PASSED [ 64%]
tests/unit/test_middleware.py::TestSecurityHeadersMiddleware::test_security_headers_production PASSED [ 64%]
tests/unit/test_middleware.py::TestSecurityHeadersMiddleware::test_security_headers_debug_mode PASSED [ 64%]
tests/unit/test_middleware.py::TestRequestLoggingMiddleware::test_request_logging_success PASSED [ 64%]
tests/unit/test_middleware.py::TestRequestLoggingMiddleware::test_request_logging_exception PASSED [ 64%]
tests/unit/test_middleware.py::TestRequestLoggingMiddleware::test_request_logging_no_client PASSED [ 64%]
tests/unit/test_middleware.py::TestPerformanceMiddleware::test_performance_headers_added PASSED [ 65%]
tests/unit/test_middleware.py::TestPerformanceMiddleware::test_performance_slow_request_logging PASSED [ 65%]
tests/unit/test_middleware.py::TestPerformanceMiddleware::test_performance_fast_request_no_warning PASSED [ 65%]
tests/unit/test_middleware.py::TestRequestSizeLimitMiddleware::test_request_size_within_limit PASSED [ 65%]
tests/unit/test_middleware.py::TestRequestSizeLimitMiddleware::test_request_size_exceeds_limit PASSED [ 65%]
tests/unit/test_middleware.py::TestRequestSizeLimitMiddleware::test_request_size_no_content_length PASSED [ 65%]
tests/unit/test_middleware.py::TestRequestSizeLimitMiddleware::test_request_size_default_limit PASSED [ 65%]
tests/unit/test_middleware.py::TestHealthCheckMiddleware::test_health_check_headers_added PASSED [ 65%]
tests/unit/test_middleware.py::TestCORSMiddleware::test_cors_preflight_request PASSED [ 65%]
tests/unit/test_middleware.py::TestCORSMiddleware::test_cors_actual_request PASSED [ 65%]
tests/unit/test_middleware.py::TestCORSMiddleware::test_cors_wildcard_origin PASSED [ 65%]
tests/unit/test_middleware.py::TestCORSMiddleware::test_cors_origin_not_allowed PASSED [ 66%]
tests/unit/test_middleware.py::TestCORSMiddleware::test_cors_expose_headers PASSED [ 66%]
tests/unit/test_middleware.py::TestCORSMiddleware::test_cors_max_age PASSED [ 66%]
tests/unit/test_oauth_routes.py::TestOAuthStart::test_oauth_start_google PASSED [ 66%]
tests/unit/test_oauth_routes.py::TestOAuthStart::test_oauth_start_github PASSED [ 66%]
tests/unit/test_oauth_routes.py::TestOAuthStart::test_oauth_start_unsupported_provider PASSED [ 66%]
tests/unit/test_oauth_routes.py::TestOAuthStart::test_oauth_start_exception_handling PASSED [ 66%]
tests/unit/test_oauth_routes.py::TestOAuthCallbackGoogle::test_google_callback_new_user_success PASSED [ 66%]
tests/unit/test_oauth_routes.py::TestOAuthCallbackGoogle::test_google_callback_existing_oauth_account PASSED [ 66%]
tests/unit/test_oauth_routes.py::TestOAuthCallbackGoogle::test_google_callback_existing_user_link_account PASSED [ 66%]
tests/unit/test_oauth_routes.py::TestOAuthCallbackGitHub::test_github_callback_with_email_success PASSED [ 67%]
tests/unit/test_oauth_routes.py::TestOAuthCallbackGitHub::test_github_callback_fetch_email_from_api PASSED [ 67%]
tests/unit/test_oauth_routes.py::TestOAuthCallbackGitHub::test_github_callback_no_email_error PASSED [ 67%]
tests/unit/test_oauth_routes.py::TestOAuthCallbackErrors::test_oauth_callback_unsupported_provider PASSED [ 67%]
tests/unit/test_oauth_routes.py::TestOAuthCallbackErrors::test_oauth_callback_token_exchange_failure PASSED [ 67%]
tests/unit/test_oauth_routes.py::TestOAuthCallbackErrors::test_oauth_callback_database_error PASSED [ 67%]
tests/unit/test_oauth_routes.py::TestOAuthCallbackErrors::test_oauth_callback_no_email_provided PASSED [ 67%]
tests/unit/test_oauth_routes.py::TestOAuthLinkUnlink::test_link_oauth_account_not_implemented PASSED [ 67%]
tests/unit/test_oauth_routes.py::TestOAuthLinkUnlink::test_unlink_oauth_account_not_implemented PASSED [ 67%]
tests/unit/test_oauth_routes.py::TestOAuthIntegration::test_complete_google_oauth_flow_new_user PASSED [ 67%]
tests/unit/test_oauth_routes.py::TestOAuthIntegration::test_complete_github_oauth_flow_existing_user PASSED [ 67%]
tests/unit/test_oauth_routes.py::TestOAuthEdgeCases::test_oauth_callback_updates_last_login PASSED [ 68%]
tests/unit/test_oauth_routes.py::TestOAuthEdgeCases::test_oauth_callback_creates_audit_log PASSED [ 68%]
tests/unit/test_oauth_routes.py::TestOAuthEdgeCases::test_github_oauth_name_fallback_to_login PASSED [ 68%]
tests/unit/test_oauth_routes.py::TestOAuthRouter::test_router_prefix PASSED [ 68%]
tests/unit/test_oauth_routes.py::TestOAuthRouter::test_router_tags PASSED [ 68%]
tests/unit/test_password_reset.py::TestForgotPassword::test_forgot_password_success PASSED [ 68%]
tests/unit/test_password_reset.py::TestForgotPassword::test_forgot_password_user_not_found PASSED [ 68%]
tests/unit/test_password_reset.py::TestForgotPassword::test_forgot_password_locked_account PASSED [ 68%]
tests/unit/test_password_reset.py::TestForgotPassword::test_forgot_password_rate_limit PASSED [ 68%]
tests/unit/test_password_reset.py::TestResetPassword::test_reset_password_success PASSED [ 68%]
tests/unit/test_password_reset.py::TestResetPassword::test_reset_password_invalid_token PASSED [ 68%]
tests/unit/test_password_reset.py::TestResetPassword::test_reset_password_weak_password PASSED [ 69%]
tests/unit/test_password_reset.py::TestResetPassword::test_reset_password_breached_password PASSED [ 69%]
tests/unit/test_password_reset.py::TestResetPassword::test_reset_password_rate_limit PASSED [ 69%]
tests/unit/test_password_reset.py::TestChangePassword::test_change_password_success PASSED [ 69%]
tests/unit/test_password_reset.py::TestChangePassword::test_change_password_invalid_current PASSED [ 69%]
tests/unit/test_password_reset.py::TestChangePassword::test_change_password_same_as_current PASSED [ 69%]
tests/unit/test_password_reset.py::TestChangePassword::test_change_password_rate_limit PASSED [ 69%]
tests/unit/test_password_reset.py::TestVerifyResetToken::test_verify_reset_token_valid PASSED [ 69%]
tests/unit/test_password_reset.py::TestVerifyResetToken::test_verify_reset_token_invalid PASSED [ 69%]
tests/unit/test_password_reset.py::TestVerifyResetToken::test_verify_reset_token_expired PASSED [ 69%]
tests/unit/test_payment_service.py::TestPaymentService::test_create_payment_intent_success PASSED [ 70%]
tests/unit/test_payment_service.py::TestPaymentService::test_create_payment_intent_negative_amount PASSED [ 70%]
tests/unit/test_payment_service.py::TestPaymentService::test_create_payment_intent_zero_amount PASSED [ 70%]
tests/unit/test_payment_service.py::TestPaymentService::test_create_payment_intent_fee_calculation PASSED [ 70%]
tests/unit/test_payment_service.py::TestPaymentService::test_confirm_payment_success PASSED [ 70%]
tests/unit/test_payment_service.py::TestPaymentService::test_confirm_payment_not_found PASSED [ 70%]
tests/unit/test_payment_service.py::TestPaymentService::test_confirm_payment_not_pending PASSED [ 70%]
tests/unit/test_payment_service.py::TestPaymentService::test_fail_payment_success PASSED [ 70%]
tests/unit/test_payment_service.py::TestPaymentService::test_fail_payment_no_reason PASSED [ 70%]
tests/unit/test_payment_service.py::TestPaymentService::test_fail_payment_not_found PASSED [ 70%]
tests/unit/test_payment_service.py::TestPaymentService::test_refund_payment_success PASSED [ 70%]
tests/unit/test_payment_service.py::TestPaymentService::test_refund_payment_not_found PASSED [ 71%]
tests/unit/test_payment_service.py::TestPaymentService::test_refund_payment_not_completed PASSED [ 71%]
tests/unit/test_payment_service.py::TestPaymentService::test_refund_payment_exceeds_amount PASSED [ 71%]
tests/unit/test_payment_service.py::TestPaymentService::test_full_refund PASSED [ 71%]
tests/unit/test_payment_service.py::TestPaymentServiceIntegration::test_payment_lifecycle PASSED [ 71%]
tests/unit/test_payment_service.py::TestPaymentServiceIntegration::test_different_payment_methods PASSED [ 71%]
tests/unit/test_posts_endpoints.py::TestPostsEndpoints::test_update_post PASSED [ 71%]
tests/unit/test_posts_endpoints.py::TestPostsEndpoints::test_like_post PASSED [ 71%]
tests/unit/test_posts_endpoints.py::TestPostsEndpoints::test_unlike_post PASSED [ 71%]
tests/unit/test_posts_endpoints.py::TestPostsEndpoints::test_get_trending_posts PASSED [ 71%]
tests/unit/test_redis.py::TestMockRedis::test_mock_redis_creation PASSED [ 71%]
tests/unit/test_redis.py::TestMockRedis::test_mock_redis_get_set PASSED  [ 72%]
tests/unit/test_redis.py::TestMockRedis::test_mock_redis_get_nonexistent PASSED [ 72%]
tests/unit/test_redis.py::TestMockRedis::test_mock_redis_set_with_ttl PASSED [ 72%]
tests/unit/test_redis.py::TestMockRedis::test_mock_redis_delete PASSED   [ 72%]
tests/unit/test_redis.py::TestMockRedis::test_mock_redis_exists PASSED   [ 72%]
tests/unit/test_redis.py::TestMockRedis::test_mock_redis_ping PASSED     [ 72%]
tests/unit/test_redis.py::TestMockRedis::test_mock_redis_close PASSED    [ 72%]
tests/unit/test_redis.py::TestRedisManager::test_redis_manager_creation PASSED [ 72%]
tests/unit/test_redis.py::TestRedisManager::test_redis_manager_init PASSED [ 72%]
tests/unit/test_redis.py::TestRedisManager::test_redis_manager_close PASSED [ 72%]
tests/unit/test_redis.py::TestRedisManager::test_redis_manager_get_set PASSED [ 72%]
tests/unit/test_redis.py::TestRedisManager::test_redis_manager_get_with_default PASSED [ 73%]
tests/unit/test_redis.py::TestRedisManager::test_redis_manager_set_with_ttl PASSED [ 73%]
tests/unit/test_redis.py::TestRedisManager::test_redis_manager_delete PASSED [ 73%]
tests/unit/test_redis.py::TestRedisManager::test_redis_manager_exists PASSED [ 73%]
tests/unit/test_redis.py::TestRedisManager::test_redis_manager_health_check PASSED [ 73%]
tests/unit/test_redis.py::TestGlobalRedisManager::test_global_redis_manager_instance PASSED [ 73%]
tests/unit/test_redis.py::TestGlobalRedisManager::test_init_redis_function PASSED [ 73%]
tests/unit/test_redis.py::TestGlobalRedisManager::test_close_redis_function PASSED [ 73%]
tests/unit/test_redis.py::TestGlobalRedisManager::test_get_redis_function PASSED [ 73%]
tests/unit/test_redis.py::TestCacheDecorator::test_cache_decorator_basic PASSED [ 73%]
tests/unit/test_redis.py::TestCacheDecorator::test_cache_decorator_different_args PASSED [ 74%]
tests/unit/test_redis.py::TestCacheDecorator::test_cache_decorator_custom_key_func PASSED [ 74%]
tests/unit/test_redis.py::TestRateLimiter::test_rate_limiter_creation PASSED [ 74%]
tests/unit/test_redis.py::TestRateLimiter::test_rate_limiter_is_allowed_first_request PASSED [ 74%]
tests/unit/test_redis.py::TestRateLimiter::test_rate_limiter_is_allowed_within_limit PASSED [ 74%]
tests/unit/test_redis.py::TestRateLimiter::test_rate_limiter_exceeds_limit PASSED [ 74%]
tests/unit/test_redis.py::TestRateLimiter::test_rate_limiter_different_keys PASSED [ 74%]
tests/unit/test_redis.py::TestRateLimiter::test_rate_limiter_burst_limit PASSED [ 74%]
tests/unit/test_redis.py::TestGlobalRateLimiter::test_global_rate_limiter_instance PASSED [ 74%]
tests/unit/test_redis.py::TestRedisManagerExceptionHandling::test_get_with_exception PASSED [ 74%]
tests/unit/test_redis.py::TestRedisManagerExceptionHandling::test_set_with_exception PASSED [ 74%]
tests/unit/test_redis.py::TestRedisManagerExceptionHandling::test_delete_with_exception PASSED [ 75%]
tests/unit/test_redis.py::TestRedisManagerExceptionHandling::test_exists_with_exception PASSED [ 75%]
tests/unit/test_redis.py::TestRedisManagerExceptionHandling::test_health_check_with_exception PASSED [ 75%]
tests/unit/test_redis.py::TestRedisErrorPaths::test_redis_manager_double_init PASSED [ 75%]
tests/unit/test_redis.py::TestRedisErrorPaths::test_redis_manager_connection_failure_fallback PASSED [ 75%]
tests/unit/test_redis.py::TestRedisErrorPaths::test_redis_library_not_available PASSED [ 75%]
tests/unit/test_redis.py::TestRedisErrorPaths::test_redis_import_error_handling PASSED [ 75%]
tests/unit/test_security.py::TestValidatePasswordStrength::test_strong_password PASSED [ 75%]
tests/unit/test_security.py::TestValidatePasswordStrength::test_weak_password_too_short PASSED [ 75%]
tests/unit/test_security.py::TestValidatePasswordStrength::test_password_no_uppercase PASSED [ 75%]
tests/unit/test_security.py::TestValidatePasswordStrength::test_password_no_lowercase PASSED [ 75%]
tests/unit/test_security.py::TestValidatePasswordStrength::test_password_no_number PASSED [ 76%]
tests/unit/test_security.py::TestSecurityManager::test_hash_password PASSED [ 76%]
tests/unit/test_security.py::TestSecurityManager::test_verify_password PASSED [ 76%]
tests/unit/test_security.py::TestSecurityManager::test_create_access_token PASSED [ 76%]
tests/unit/test_security.py::TestSecurityManager::test_verify_token PASSED [ 76%]
tests/unit/test_security.py::TestSecurityManager::test_generate_api_key PASSED [ 76%]
tests/unit/test_security.py::TestSecurityManager::test_create_access_token_with_custom_expiry PASSED [ 76%]
tests/unit/test_security.py::TestSecurityManager::test_verify_token_expired PASSED [ 76%]
tests/unit/test_security.py::TestSecurityManager::test_verify_token_wrong_type PASSED [ 76%]
tests/unit/test_security.py::TestSecurityManager::test_verify_token_invalid PASSED [ 76%]
tests/unit/test_security.py::TestSecurityManager::test_verify_token_generic_exception PASSED [ 77%]
tests/unit/test_security.py::TestSecurityManager::test_password_strength_weak PASSED [ 77%]
tests/unit/test_security.py::TestSecurityFunctions::test_setup_security PASSED [ 77%]
tests/unit/test_security.py::TestSecurityFunctions::test_get_cors_origins_development PASSED [ 77%]
tests/unit/test_security.py::TestSecurityFunctions::test_get_cors_origins_production PASSED [ 77%]
tests/unit/test_security.py::TestSecurityFunctions::test_get_cors_origins_test_environment PASSED [ 77%]
tests/unit/test_security.py::TestSecurityFunctions::test_get_current_user_token PASSED [ 77%]
tests/unit/test_security.py::TestSecurityFunctions::test_get_current_user_token_invalid PASSED [ 77%]
tests/unit/test_shop_service.py::TestShopService::test_shop_service_creation PASSED [ 77%]
tests/unit/test_shop_service.py::TestShopService::test_create_product_success PASSED [ 77%]
tests/unit/test_shop_service.py::TestShopService::test_get_product_by_id_success PASSED [ 77%]
tests/unit/test_shop_service.py::TestShopService::test_get_product_by_id_not_found PASSED [ 78%]
tests/unit/test_shop_service.py::TestShopService::test_get_product_by_slug_success PASSED [ 78%]
tests/unit/test_shop_service.py::TestShopService::test_update_product_success PASSED [ 78%]
tests/unit/test_shop_service.py::TestShopService::test_update_product_not_found PASSED [ 78%]
tests/unit/test_shop_service.py::TestShopService::test_delete_product_success PASSED [ 78%]
tests/unit/test_shop_service.py::TestShopService::test_delete_product_not_found PASSED [ 78%]
tests/unit/test_shop_service.py::TestShopService::test_list_products_success PASSED [ 78%]
tests/unit/test_shop_service.py::TestShopService::test_list_products_with_filters PASSED [ 78%]
tests/unit/test_shop_service.py::TestShopService::test_list_products_with_search PASSED [ 78%]
tests/unit/test_shop_service.py::TestShopService::test_list_products_include_inactive PASSED [ 78%]
tests/unit/test_shop_service.py::TestShopService::test_list_products_sort_ascending PASSED [ 78%]
tests/unit/test_shop_service.py::TestShopService::test_search_products_success PASSED [ 79%]
tests/unit/test_shop_service.py::TestShopService::test_search_products_with_filters PASSED [ 79%]
tests/unit/test_shop_service.py::TestShopService::test_get_featured_products_success PASSED [ 79%]
tests/unit/test_shop_service.py::TestShopService::test_get_related_products_success PASSED [ 79%]
tests/unit/test_shop_service.py::TestShopService::test_get_related_products_no_product PASSED [ 79%]
tests/unit/test_shop_service.py::TestShopService::test_update_product_stock_success PASSED [ 79%]
tests/unit/test_shop_service.py::TestShopService::test_update_product_stock_to_zero PASSED [ 79%]
tests/unit/test_shop_service.py::TestShopService::test_update_product_stock_from_out_of_stock PASSED [ 79%]
tests/unit/test_shop_service.py::TestShopService::test_update_product_stock_digital_product PASSED [ 79%]
tests/unit/test_shop_service.py::TestShopService::test_update_product_stock_insufficient PASSED [ 79%]
tests/unit/test_shop_service.py::TestShopService::test_update_product_stock_not_found PASSED [ 80%]
tests/unit/test_shop_service.py::TestShopService::test_get_user_cart_existing PASSED [ 80%]
tests/unit/test_shop_service.py::TestShopService::test_get_user_cart_create_new PASSED [ 80%]
tests/unit/test_shop_service.py::TestShopService::test_add_to_cart_success PASSED [ 80%]
tests/unit/test_shop_service.py::TestShopService::test_add_to_cart_update_existing_item PASSED [ 80%]
tests/unit/test_shop_service.py::TestShopService::test_add_to_cart_existing_item_insufficient_stock PASSED [ 80%]
tests/unit/test_shop_service.py::TestShopService::test_add_to_cart_invalid_quantity PASSED [ 80%]
tests/unit/test_shop_service.py::TestShopService::test_add_to_cart_product_not_found PASSED [ 80%]
tests/unit/test_shop_service.py::TestShopService::test_add_to_cart_product_not_active PASSED [ 80%]
tests/unit/test_shop_service.py::TestShopService::test_add_to_cart_insufficient_stock PASSED [ 80%]
tests/unit/test_shop_service.py::TestShopService::test_add_to_cart_digital_product_no_stock_check PASSED [ 80%]
tests/unit/test_shop_service.py::TestShopService::test_update_cart_item_success PASSED [ 81%]
tests/unit/test_shop_service.py::TestShopService::test_update_cart_item_remove_when_zero PASSED [ 81%]
tests/unit/test_shop_service.py::TestShopService::test_update_cart_item_negative_quantity PASSED [ 81%]
tests/unit/test_shop_service.py::TestShopService::test_update_cart_item_not_found PASSED [ 81%]
tests/unit/test_shop_service.py::TestShopService::test_update_cart_item_insufficient_stock PASSED [ 81%]
tests/unit/test_shop_service.py::TestShopService::test_remove_from_cart_success PASSED [ 81%]
tests/unit/test_shop_service.py::TestShopService::test_remove_from_cart_item_not_found PASSED [ 81%]
tests/unit/test_shop_service.py::TestShopService::test_clear_cart_success PASSED [ 81%]
tests/unit/test_shop_service.py::TestShopService::test_create_order_from_cart_success PASSED [ 81%]
tests/unit/test_shop_service.py::TestShopService::test_create_order_from_cart_free_shipping PASSED [ 81%]
tests/unit/test_shop_service.py::TestShopService::test_create_order_from_cart_empty_cart PASSED [ 81%]
tests/unit/test_shop_service.py::TestShopService::test_get_order_by_id_success PASSED [ 82%]
tests/unit/test_shop_service.py::TestShopService::test_get_user_orders_success PASSED [ 82%]
tests/unit/test_shop_service.py::TestShopService::test_get_user_orders_with_status_filter PASSED [ 82%]
tests/unit/test_shop_service.py::TestShopService::test_list_orders_success PASSED [ 82%]
tests/unit/test_shop_service.py::TestShopService::test_list_orders_with_filters PASSED [ 82%]
tests/unit/test_shop_service.py::TestShopService::test_update_order_status_success PASSED [ 82%]
tests/unit/test_shop_service.py::TestShopService::test_update_order_status_with_tracking PASSED [ 82%]
tests/unit/test_shop_service.py::TestShopService::test_update_order_status_to_delivered PASSED [ 82%]
tests/unit/test_shop_service.py::TestShopService::test_update_order_status_not_found PASSED [ 82%]
tests/unit/test_shop_service.py::TestShopService::test_cancel_order_success PASSED [ 82%]
tests/unit/test_shop_service.py::TestShopService::test_cancel_order_not_found PASSED [ 82%]
tests/unit/test_shop_service.py::TestShopService::test_cancel_order_invalid_status PASSED [ 83%]
tests/unit/test_shop_service.py::TestShopService::test_create_product_review_success PASSED [ 83%]
tests/unit/test_shop_service.py::TestShopService::test_create_product_review_invalid_rating PASSED [ 83%]
tests/unit/test_shop_service.py::TestShopService::test_create_product_review_duplicate PASSED [ 83%]
tests/unit/test_shop_service.py::TestShopService::test_get_product_reviews_success PASSED [ 83%]
tests/unit/test_shop_service.py::TestShopService::test_get_product_reviews_with_rating_filter PASSED [ 83%]
tests/unit/test_shop_service.py::TestShopService::test_get_product_review_stats_success PASSED [ 83%]
tests/unit/test_shop_service.py::TestShopService::test_get_product_review_stats_no_reviews PASSED [ 83%]
tests/unit/test_shop_service.py::TestShopService::test_has_user_purchased_product_true PASSED [ 83%]
tests/unit/test_shop_service.py::TestShopService::test_has_user_purchased_product_false PASSED [ 83%]
tests/unit/test_shop_service.py::TestShopService::test_get_sales_analytics_success PASSED [ 84%]
tests/unit/test_shop_service.py::TestShopService::test_get_sales_analytics_with_date_range PASSED [ 84%]
tests/unit/test_shop_service.py::TestShopService::test_get_sales_analytics_no_orders PASSED [ 84%]
tests/unit/test_shop_service.py::TestShopServiceHelperMethods::test_generate_slug_basic PASSED [ 84%]
tests/unit/test_shop_service.py::TestShopServiceHelperMethods::test_generate_slug_special_characters PASSED [ 84%]
tests/unit/test_shop_service.py::TestShopServiceHelperMethods::test_generate_slug_multiple_spaces PASSED [ 84%]
tests/unit/test_shop_service.py::TestShopServiceHelperMethods::test_generate_slug_empty_string PASSED [ 84%]
tests/unit/test_shop_service.py::TestShopServiceHelperMethods::test_generate_slug_numbers PASSED [ 84%]
tests/unit/test_shop_service.py::TestShopServiceHelperMethods::test_ensure_unique_slug_already_unique PASSED [ 84%]
tests/unit/test_shop_service.py::TestShopServiceHelperMethods::test_ensure_unique_slug_duplicate PASSED [ 84%]
tests/unit/test_shop_service.py::TestShopServiceHelperMethods::test_ensure_unique_slug_multiple_duplicates PASSED [ 84%]
tests/unit/test_shop_service.py::TestShopServiceHelperMethods::test_update_cart_totals PASSED [ 85%]
tests/unit/test_shop_service.py::TestShopServiceHelperMethods::test_update_cart_totals_empty_cart PASSED [ 85%]
tests/unit/test_shop_service.py::TestShopServiceHelperMethods::test_update_product_rating PASSED [ 85%]
tests/unit/test_shop_service.py::TestShopServiceHelperMethods::test_update_product_rating_no_reviews PASSED [ 85%]
tests/unit/test_totp_routes.py::TestGetCurrentUserFromToken::test_missing_authorization_header PASSED [ 85%]
tests/unit/test_totp_routes.py::TestGetCurrentUserFromToken::test_invalid_authorization_format PASSED [ 85%]
tests/unit/test_totp_routes.py::TestGetCurrentUserFromToken::test_invalid_token PASSED [ 85%]
tests/unit/test_totp_routes.py::TestGetCurrentUserFromToken::test_user_not_found PASSED [ 85%]
tests/unit/test_totp_routes.py::TestGetCurrentUserFromToken::test_success PASSED [ 85%]
tests/unit/test_totp_routes.py::TestSetup2FA::test_setup_2fa_already_enabled PASSED [ 85%]
tests/unit/test_totp_routes.py::TestSetup2FA::test_setup_2fa_success PASSED [ 85%]
tests/unit/test_totp_routes.py::TestVerify2FASetup::test_verify_setup_no_pending_setup PASSED [ 86%]
tests/unit/test_totp_routes.py::TestVerify2FASetup::test_verify_setup_invalid_code PASSED [ 86%]
tests/unit/test_totp_routes.py::TestVerify2FASetup::test_verify_setup_success PASSED [ 86%]
tests/unit/test_totp_routes.py::TestVerify2FALogin::test_verify_login_invalid_temp_token PASSED [ 86%]
tests/unit/test_totp_routes.py::TestVerify2FALogin::test_verify_login_user_not_found PASSED [ 86%]
tests/unit/test_totp_routes.py::TestVerify2FALogin::test_verify_login_2fa_not_enabled PASSED [ 86%]
tests/unit/test_totp_routes.py::TestVerify2FALogin::test_verify_login_invalid_code PASSED [ 86%]
tests/unit/test_totp_routes.py::TestVerify2FALogin::test_verify_login_success_with_totp PASSED [ 86%]
tests/unit/test_totp_routes.py::TestVerify2FALogin::test_verify_login_success_with_backup_code PASSED [ 86%]
tests/unit/test_totp_routes.py::TestVerify2FALogin::test_verify_login_backup_code_low_warning PASSED [ 86%]
tests/unit/test_totp_routes.py::TestDisable2FA::test_disable_2fa_not_enabled PASSED [ 87%]
tests/unit/test_totp_routes.py::TestDisable2FA::test_disable_2fa_invalid_password PASSED [ 87%]
tests/unit/test_totp_routes.py::TestDisable2FA::test_disable_2fa_no_credential PASSED [ 87%]
tests/unit/test_totp_routes.py::TestDisable2FA::test_disable_2fa_with_invalid_totp_code PASSED [ 87%]
tests/unit/test_totp_routes.py::TestDisable2FA::test_disable_2fa_success_with_password_only PASSED [ 87%]
tests/unit/test_totp_routes.py::TestDisable2FA::test_disable_2fa_success_with_totp_code PASSED [ 87%]
tests/unit/test_totp_routes.py::TestDisable2FA::test_disable_2fa_success_with_backup_code PASSED [ 87%]
tests/unit/test_totp_routes.py::TestRegenerateBackupCodes::test_regenerate_2fa_not_enabled PASSED [ 87%]
tests/unit/test_totp_routes.py::TestRegenerateBackupCodes::test_regenerate_invalid_password PASSED [ 87%]
tests/unit/test_totp_routes.py::TestRegenerateBackupCodes::test_regenerate_no_credential PASSED [ 87%]
tests/unit/test_totp_routes.py::TestRegenerateBackupCodes::test_regenerate_success PASSED [ 87%]
tests/unit/test_totp_routes.py::TestGet2FAStatus::test_status_2fa_disabled PASSED [ 88%]
tests/unit/test_totp_routes.py::TestGet2FAStatus::test_status_2fa_enabled PASSED [ 88%]
tests/unit/test_totp_routes.py::TestGet2FAStatus::test_status_2fa_enabled_no_backup_codes PASSED [ 88%]
tests/unit/test_tuition_service.py::TestSessionManagement::test_create_session_success PASSED [ 88%]
tests/unit/test_tuition_service.py::TestSessionManagement::test_create_session_course_not_found PASSED [ 88%]
tests/unit/test_tuition_service.py::TestSessionManagement::test_create_session_unauthorized_teacher PASSED [ 88%]
tests/unit/test_tuition_service.py::TestSessionManagement::test_create_session_scheduling_conflict PASSED [ 88%]
tests/unit/test_tuition_service.py::TestSessionManagement::test_get_session_by_id PASSED [ 88%]
tests/unit/test_tuition_service.py::TestSessionManagement::test_update_session_success PASSED [ 88%]
tests/unit/test_tuition_service.py::TestSessionManagement::test_update_session_not_found PASSED [ 88%]
tests/unit/test_tuition_service.py::TestSessionManagement::test_start_session_success PASSED [ 88%]
tests/unit/test_tuition_service.py::TestSessionManagement::test_start_session_unauthorized PASSED [ 89%]
tests/unit/test_tuition_service.py::TestSessionManagement::test_start_session_invalid_status PASSED [ 89%]
tests/unit/test_tuition_service.py::TestSessionManagement::test_end_session_success PASSED [ 89%]
tests/unit/test_tuition_service.py::TestSessionManagement::test_list_sessions_with_filters PASSED [ 89%]
tests/unit/test_tuition_service.py::TestAttendance::test_mark_attendance_new_record PASSED [ 89%]
tests/unit/test_tuition_service.py::TestAttendance::test_mark_attendance_update_existing PASSED [ 89%]
tests/unit/test_tuition_service.py::TestAttendance::test_mark_attendance_student_not_enrolled PASSED [ 89%]
tests/unit/test_tuition_service.py::TestAttendance::test_mark_bulk_attendance PASSED [ 89%]
tests/unit/test_tuition_service.py::TestAttendance::test_get_session_attendance PASSED [ 89%]
tests/unit/test_tuition_service.py::TestAssignments::test_create_assignment_success PASSED [ 89%]
tests/unit/test_tuition_service.py::TestAssignments::test_create_assignment_unauthorized PASSED [ 90%]
tests/unit/test_tuition_service.py::TestAssignments::test_submit_assignment_success PASSED [ 90%]
tests/unit/test_tuition_service.py::TestAssignments::test_submit_assignment_not_published PASSED [ 90%]
tests/unit/test_tuition_service.py::TestAssignments::test_submit_assignment_already_submitted PASSED [ 90%]
tests/unit/test_tuition_service.py::TestAssignments::test_grade_submission_success PASSED [ 90%]
tests/unit/test_tuition_service.py::TestQuizzes::test_create_quiz_success PASSED [ 90%]
tests/unit/test_tuition_service.py::TestQuizzes::test_start_quiz_attempt_success PASSED [ 90%]
tests/unit/test_tuition_service.py::TestQuizzes::test_start_quiz_attempt_max_attempts_reached PASSED [ 90%]
tests/unit/test_tuition_service.py::TestQuizzes::test_submit_quiz_attempt_success PASSED [ 90%]
tests/unit/test_tuition_service.py::TestStudyMaterials::test_create_study_material_success PASSED [ 90%]
tests/unit/test_tuition_service.py::TestStudyMaterials::test_list_study_materials_with_access_control PASSED [ 90%]
tests/unit/test_tuition_service.py::TestStudyMaterials::test_increment_material_view_count PASSED [ 91%]
tests/unit/test_tuition_service.py::TestProgressReports::test_generate_progress_report PASSED [ 91%]
tests/unit/test_tuition_service.py::TestAnalytics::test_get_course_analytics PASSED [ 91%]
tests/unit/test_tuition_service.py::TestAnalytics::test_get_student_analytics PASSED [ 91%]
tests/unit/test_tuition_service.py::TestPermissionChecks::test_check_session_access_admin PASSED [ 91%]
tests/unit/test_tuition_service.py::TestPermissionChecks::test_check_session_access_teacher PASSED [ 91%]
tests/unit/test_tuition_service.py::TestPermissionChecks::test_check_session_access_student_enrolled PASSED [ 91%]
tests/unit/test_tuition_service.py::TestPermissionChecks::test_check_assignment_access PASSED [ 91%]
tests/unit/test_tuition_service.py::TestPermissionChecks::test_check_material_access PASSED [ 91%]
tests/unit/test_tuition_service.py::TestHelperMethods::test_check_session_conflicts_no_conflict PASSED [ 91%]
tests/unit/test_tuition_service.py::TestHelperMethods::test_get_student_enrollment_by_course PASSED [ 91%]
tests/unit/test_tuition_service.py::TestHelperMethods::test_calculate_attendance_stats PASSED [ 92%]
tests/unit/test_tuition_service.py::TestHelperMethods::test_calculate_assignment_stats PASSED [ 92%]
tests/unit/test_tuition_service.py::TestHelperMethods::test_calculate_quiz_stats PASSED [ 92%]
tests/unit/test_tuition_service.py::TestSessionUpdateWithConflicts::test_update_session_with_date_time_change_conflict PASSED [ 92%]
tests/unit/test_tuition_service.py::TestSessionUpdateWithConflicts::test_update_session_with_date_time_change_no_conflict PASSED [ 92%]
tests/unit/test_tuition_service.py::TestSessionListingEdgeCases::test_list_sessions_with_start_date_filter PASSED [ 92%]
tests/unit/test_tuition_service.py::TestSessionListingEdgeCases::test_list_sessions_with_end_date_filter PASSED [ 92%]
tests/unit/test_tuition_service.py::TestStudentSessions::test_get_student_sessions_no_enrollments PASSED [ 92%]
tests/unit/test_tuition_service.py::TestStudentSessions::test_get_student_sessions_with_filters PASSED [ 92%]
tests/unit/test_tuition_service.py::TestStudentSessions::test_get_student_upcoming_sessions PASSED [ 92%]
tests/unit/test_tuition_service.py::TestTeacherSessions::test_get_teacher_sessions PASSED [ 92%]
tests/unit/test_tuition_service.py::TestTeacherSessions::test_get_teacher_upcoming_sessions PASSED [ 93%]
tests/unit/test_tuition_service.py::TestUpcomingSessions::test_get_upcoming_sessions PASSED [ 93%]
tests/unit/test_tuition_service.py::TestStartEndSessionErrors::test_start_session_not_found PASSED [ 93%]
tests/unit/test_tuition_service.py::TestStartEndSessionErrors::test_end_session_not_found PASSED [ 93%]
tests/unit/test_tuition_service.py::TestStartEndSessionErrors::test_end_session_unauthorized PASSED [ 93%]
tests/unit/test_tuition_service.py::TestStartEndSessionErrors::test_end_session_invalid_status PASSED [ 93%]
tests/unit/test_tuition_service.py::TestAttendanceEdgeCases::test_get_student_attendance_with_filters PASSED [ 93%]
tests/unit/test_tuition_service.py::TestAssignmentEdgeCases::test_create_assignment_course_not_found PASSED [ 93%]
tests/unit/test_tuition_service.py::TestAssignmentEdgeCases::test_get_assignment_by_id PASSED [ 93%]
tests/unit/test_tuition_service.py::TestAssignmentEdgeCases::test_list_assignments_with_filters PASSED [ 93%]
tests/unit/test_tuition_service.py::TestAssignmentEdgeCases::test_get_student_assignments_no_enrollments PASSED [ 94%]
tests/unit/test_tuition_service.py::TestAssignmentEdgeCases::test_get_student_assignments_with_course_filter PASSED [ 94%]
tests/unit/test_tuition_service.py::TestAssignmentEdgeCases::test_get_teacher_assignments PASSED [ 94%]
tests/unit/test_tuition_service.py::TestAssignmentEdgeCases::test_submit_assignment_not_found PASSED [ 94%]
tests/unit/test_tuition_service.py::TestAssignmentEdgeCases::test_submit_assignment_student_not_enrolled PASSED [ 94%]
tests/unit/test_tuition_service.py::TestAssignmentEdgeCases::test_submit_assignment_late_not_allowed PASSED [ 94%]
tests/unit/test_tuition_service.py::TestAssignmentEdgeCases::test_get_assignment_submissions PASSED [ 94%]
tests/unit/test_tuition_service.py::TestAssignmentEdgeCases::test_get_student_assignment_submission PASSED [ 94%]
tests/unit/test_tuition_service.py::TestAssignmentEdgeCases::test_get_submission_by_id PASSED [ 94%]
tests/unit/test_tuition_service.py::TestAssignmentEdgeCases::test_grade_submission_not_found PASSED [ 94%]
tests/unit/test_tuition_service.py::TestStudyMaterialEdgeCases::test_create_study_material_course_not_found PASSED [ 94%]
tests/unit/test_tuition_service.py::TestStudyMaterialEdgeCases::test_create_study_material_unauthorized PASSED [ 95%]
tests/unit/test_tuition_service.py::TestStudyMaterialEdgeCases::test_get_study_material_by_id PASSED [ 95%]
tests/unit/test_tuition_service.py::TestStudyMaterialEdgeCases::test_list_study_materials_teacher_access PASSED [ 95%]
tests/unit/test_tuition_service.py::TestStudyMaterialEdgeCases::test_list_study_materials_with_all_filters PASSED [ 95%]
tests/unit/test_tuition_service.py::TestStudyMaterialEdgeCases::test_increment_material_view_count_not_found PASSED [ 95%]
tests/unit/test_tuition_service.py::TestQuizEdgeCases::test_create_quiz_course_not_found PASSED [ 95%]
tests/unit/test_tuition_service.py::TestQuizEdgeCases::test_create_quiz_unauthorized PASSED [ 95%]
tests/unit/test_tuition_service.py::TestQuizEdgeCases::test_get_quiz_by_id PASSED [ 95%]
tests/unit/test_tuition_service.py::TestQuizEdgeCases::test_list_quizzes_with_filters PASSED [ 95%]
tests/unit/test_tuition_service.py::TestQuizEdgeCases::test_get_student_available_quizzes_no_enrollments PASSED [ 95%]
tests/unit/test_tuition_service.py::TestQuizEdgeCases::test_get_student_available_quizzes_with_course_filter PASSED [ 95%]
tests/unit/test_tuition_service.py::TestQuizEdgeCases::test_get_teacher_quizzes PASSED [ 96%]
tests/unit/test_tuition_service.py::TestQuizEdgeCases::test_start_quiz_attempt_not_found PASSED [ 96%]
tests/unit/test_tuition_service.py::TestQuizEdgeCases::test_start_quiz_attempt_not_available PASSED [ 96%]
tests/unit/test_tuition_service.py::TestQuizEdgeCases::test_start_quiz_attempt_student_not_enrolled PASSED [ 96%]
tests/unit/test_tuition_service.py::TestQuizEdgeCases::test_submit_quiz_attempt_not_found PASSED [ 96%]
tests/unit/test_tuition_service.py::TestQuizEdgeCases::test_submit_quiz_attempt_already_submitted PASSED [ 96%]
tests/unit/test_tuition_service.py::TestQuizEdgeCases::test_submit_quiz_attempt_time_limit_exceeded PASSED [ 96%]
tests/unit/test_tuition_service.py::TestQuizEdgeCases::test_submit_quiz_attempt_true_false_question PASSED [ 96%]
tests/unit/test_tuition_service.py::TestQuizEdgeCases::test_get_quiz_attempt_by_id PASSED [ 96%]
tests/unit/test_tuition_service.py::TestQuizEdgeCases::test_get_quiz_attempt_count PASSED [ 96%]
tests/unit/test_tuition_service.py::TestProgressReportsEdgeCases::test_generate_progress_report_not_found PASSED [ 97%]
tests/unit/test_tuition_service.py::TestProgressReportsEdgeCases::test_generate_progress_report_grade_B PASSED [ 97%]
tests/unit/test_tuition_service.py::TestProgressReportsEdgeCases::test_generate_progress_report_grade_C PASSED [ 97%]
tests/unit/test_tuition_service.py::TestProgressReportsEdgeCases::test_generate_progress_report_grade_D PASSED [ 97%]
tests/unit/test_tuition_service.py::TestProgressReportsEdgeCases::test_generate_progress_report_grade_F PASSED [ 97%]
tests/unit/test_tuition_service.py::TestProgressReportsEdgeCases::test_get_progress_reports_with_filters PASSED [ 97%]
tests/unit/test_tuition_service.py::TestAnalyticsEdgeCases::test_get_course_analytics_with_date_filters PASSED [ 97%]
tests/unit/test_tuition_service.py::TestAnalyticsEdgeCases::test_get_student_analytics_with_course_filter PASSED [ 97%]
tests/unit/test_tuition_service.py::TestPermissionChecksEdgeCases::test_check_session_access_session_not_found PASSED [ 97%]
tests/unit/test_tuition_service.py::TestPermissionChecksEdgeCases::test_check_session_access_student_not_enrolled PASSED [ 97%]
tests/unit/test_tuition_service.py::TestPermissionChecksEdgeCases::test_check_session_access_unknown_role PASSED [ 97%]
tests/unit/test_tuition_service.py::TestPermissionChecksEdgeCases::test_check_assignment_access_not_found PASSED [ 98%]
tests/unit/test_tuition_service.py::TestPermissionChecksEdgeCases::test_check_assignment_access_student_unpublished PASSED [ 98%]
tests/unit/test_tuition_service.py::TestPermissionChecksEdgeCases::test_check_assignment_access_student_not_enrolled PASSED [ 98%]
tests/unit/test_tuition_service.py::TestPermissionChecksEdgeCases::test_check_assignment_access_unknown_role PASSED [ 98%]
tests/unit/test_tuition_service.py::TestPermissionChecksEdgeCases::test_check_material_access_not_found PASSED [ 98%]
tests/unit/test_tuition_service.py::TestPermissionChecksEdgeCases::test_check_material_access_teacher_private PASSED [ 98%]
tests/unit/test_tuition_service.py::TestPermissionChecksEdgeCases::test_check_material_access_student_requires_enrollment PASSED [ 98%]
tests/unit/test_tuition_service.py::TestPermissionChecksEdgeCases::test_check_material_access_student_not_enrolled PASSED [ 98%]
tests/unit/test_tuition_service.py::TestPermissionChecksEdgeCases::test_check_material_access_unknown_role PASSED [ 98%]
tests/unit/test_tuition_service.py::TestPermissionChecksEdgeCases::test_can_teacher_create_session PASSED [ 98%]
tests/unit/test_tuition_service.py::TestPermissionChecksEdgeCases::test_can_teacher_create_assignment PASSED [ 98%]
tests/unit/test_tuition_service.py::TestPermissionChecksEdgeCases::test_can_teacher_view_course PASSED [ 99%]
tests/unit/test_tuition_service.py::TestHelperMethodsEdgeCases::test_check_session_conflicts_with_conflict PASSED [ 99%]
tests/unit/test_tuition_service.py::TestHelperMethodsEdgeCases::test_check_session_conflicts_exclude_session PASSED [ 99%]
tests/unit/test_tuition_service.py::TestHelperMethodsEdgeCases::test_get_student_enrollment_session_not_found PASSED [ 99%]
tests/unit/test_tuition_service.py::TestHelperMethodsEdgeCases::test_get_student_enrollment_success PASSED [ 99%]
tests/unit/test_tuition_service.py::TestTuitionServiceEdgeCases::test_list_assignments_with_published_only_filter PASSED [ 99%]
tests/unit/test_tuition_service.py::TestTuitionServiceEdgeCases::test_check_assignment_access_as_teacher PASSED [ 99%]
tests/unit/test_tuition_service.py::TestTuitionServiceEdgeCases::test_check_material_access_as_teacher PASSED [ 99%]
tests/unit/test_tuition_service.py::TestTuitionServiceEdgeCases::test_generate_progress_report_grade_A PASSED [ 99%]
tests/unit/test_tuition_service.py::TestTuitionServiceEdgeCases::test_check_assignment_access_as_admin PASSED [ 99%]
tests/unit/test_tuition_service.py::TestTuitionServiceEdgeCases::test_check_material_access_as_admin PASSED [100%]

================================== FAILURES ===================================
__________________ TestGlobalInstance.test_get_redis_service __________________
tests\unit\test_auth_redis_service.py:705: in test_get_redis_service
    assert result == mock_service
E   AssertionError: assert <AsyncMock name='RedisService()' id='2928721392848'> == <Mock id='2928721388480'>
        mock_service = <Mock id='2928721388480'>
        redis_module = <module 'app.auth.redis_service' from 'C:\\Users\\A.P\\OneDrive\\Desktop\\echo-main\\backend\\app\\auth\\redis_service.py'>
        result     = <AsyncMock name='RedisService()' id='2928721392848'>
        self       = <tests.unit.test_auth_redis_service.TestGlobalInstance object at 0x000002A9E358AAD0>
=============================== tests coverage ================================
_______________ coverage: platform win32, python 3.13.7-final-0 _______________

Name                              Stmts   Miss  Cover   Missing
---------------------------------------------------------------
app\api\v1\__init__.py               65     21    68%   10-11, 15-16, 20-21, 25-26, 30-31, 35-36, 40-41, 45-46, 50-51, 55-56, 86
app\api\v1\endpoints\admin.py        19      6    68%   11, 24-47, 53, 59, 65
app\api\v1\endpoints\auth.py         30      4    87%   37, 46, 55, 62
app\api\v1\endpoints\chat.py        133     28    79%   60, 138-148, 185-195, 275-277, 305-307, 320-322, 330-348, 353-379, 393, 411
app\api\v1\endpoints\files.py       128     47    63%   66, 69, 72, 99, 110, 123, 135, 137, 163-239, 247, 260, 274, 290, 303
app\api\v1\endpoints\shop.py        195      3    98%   207, 368, 461
app\api\v1\endpoints\tuition.py     264     34    87%   83, 109-114, 166, 191, 194, 198, 234, 290, 346-355, 377, 400, 413, 464, 467, 472, 495, 505, 509, 560, 570, 588, 614, 661-670, 685, 725, 734, 826-827
app\api\v1\endpoints\users.py        84     32    62%   47-52, 71-86, 105-120, 168-173
app\auth\password_reset.py          130      5    96%   220, 227, 292, 316, 323
app\auth\routes.py                  362     19    95%   41-46, 51-55, 315-330, 420-423, 590, 837
app\config\settings.py               97      4    96%   98, 105, 166, 170
app\core\config.py                  183      5    97%   156-161
app\core\csrf.py                     56     33    41%   32, 37, 42, 50-57, 90-147, 152, 157-166
app\core\database.py                113     10    91%   70-77, 82, 87
app\core\redis.py                   139      3    98%   120-122
app\main.py                          92      3    97%   151, 181-182
---------------------------------------------------------------
TOTAL                              5732    257    96%

34 files skipped due to complete coverage.
Coverage HTML written to dir htmlcov
Coverage XML written to file coverage.xml
Required test coverage of 40% reached. Total coverage: 95.52%
=========================== short test summary info ===========================
FAILED tests/unit/test_auth_redis_service.py::TestGlobalInstance::test_get_redis_service
================= 1 failed, 1069 passed in 152.76s (0:02:32) ==================
